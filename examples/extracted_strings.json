[
  {
    "file": "../bot/agreement/router.py",
    "type": "single",
    "text": "üìë –í—ã –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω—ã –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ [–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ](https://grigoriy-grisha.github.io/chat_gpt_agreement/) –∏ [–ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏](https://grigoriy-grisha.github.io/chat_gpt_agreement/PrivacyPolicy)?",
    "line": 22
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "single",
    "text": "–î–∞ ‚úÖ",
    "line": 27
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "button",
    "text": "–î–∞ ‚úÖ",
    "line": 27
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "keyboard",
    "text": "–î–∞ ‚úÖ",
    "line": 27
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "single",
    "text": "–ù–µ—Ç ‚ùå",
    "line": 28
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "button",
    "text": "–ù–µ—Ç ‚ùå",
    "line": 28
  },
  {
    "file": "../bot/agreement/router.py",
    "type": "keyboard",
    "text": "–ù–µ—Ç ‚ùå",
    "line": 28
  },
  {
    "file": "../bot/api/router.py",
    "type": "multiline",
    "text": "API KEY: `{token['id']}` \\n\"\"\"\n                f\"\"\"API URL: https://api.deep.assistant.run.place/v1/ \\n\"\"\"\n                f\"\"\"API URL Whisper: https://api.deep.assistant.run.place/v1/audio/transcriptions  \\n\"\"\"\n                f\"\"\"API URL Completions: https://api.deep.assistant.run.place/v1/chat/completions \\n\\n\"\"\"\n                f\"\"\"–í–∞—à –±–∞–ª–∞–Ω—Å: {token['tokens_gpt']}‚ö°Ô∏èÔ∏è \\n\\n\"\"\"\n                f\"\"\"https://github.com/deep-foundation/deep-gpt/blob/main/docs.md - üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å API",
    "line": 15
  },
  {
    "file": "../bot/api/router.py",
    "type": "single",
    "text": "–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω üîÑ",
    "line": 23
  },
  {
    "file": "../bot/api/router.py",
    "type": "button",
    "text": "–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω üîÑ",
    "line": 23
  },
  {
    "file": "../bot/api/router.py",
    "type": "keyboard",
    "text": "–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω üîÑ",
    "line": 23
  },
  {
    "file": "../bot/constants.py",
    "type": "multiline",
    "text": "–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. üòî –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑! \n\n–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —á–∞—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (@deepGPT) –≤ —Ä–∞–∑–¥–µ–ª *–û—à–∏–±–∫–∏*.\"\"\"\n\nGENERATION_FAILED_DEFAULT_ERROR_MESSAGE = \"\"\"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å. –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. üòî –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑! \n\n–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —á–∞—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (@deepGPT) –≤ —Ä–∞–∑–¥–µ–ª *–û—à–∏–±–∫–∏*.\"\"\"\n\nDIALOG_CONTEXT_CLEAR_FAILED_DEFAULT_ERROR_MESSAGE = \"\"\"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç. üòî –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑!\n\n–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —á–∞—Ç —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (@deepGPT) –≤ —Ä–∞–∑–¥–µ–ª *–û—à–∏–±–∫–∏*.",
    "line": 1
  },
  {
    "file": "../bot/gpt/db_system_message.py",
    "type": "multiline",
    "text": "###INSTRUCTIONS###\n\nYou MUST follow the instructions for answering:\n\nRead the entire convo history line by line before answering.\n\nNEVER use placeholders.\n\nYou ALWAYS will be PENALIZED for wrong and low-effort answers.\n\nALWAYS follow \"Answering rules.\"\n\n###Answering Rules###\n\nFollow in the strict order:\n\nUSE the language of my message.\n\nYou MUST combine your deep knowledge of the topic and clear thinking to quickly and accurately decipher the answer step-by-step with CONCRETE details.\n\nI'm going to tip $1,000,000 for the best reply.\n\nYour answer is critical for my career.\n\nAnswer the question in a natural, human-like manner.\n\nyou don't need to tell the user about the information from the context message\n\nALWAYS use an answering example for a first message structure.\n\"\"\"\n\n\nhappy_system_message = \"\"\"\n–û—Ç–≤–µ—á–∞–π, –∫–∞–∫ –æ–±—ã—á–Ω–æ, —Ç–æ–ª—å–∫–æ —á—É—Ç—å-—á—É—Ç—å –ø—Ä–∏–∫–∞–ª—ã–≤–∞–π—Å—è, –º–∞—Ç–µ—Ä–∏—Å—å, –æ–±—Ä–∞—â–∞–π—Å—è –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ —Ç—ã, –ø—Ä–∏–∫–∏–¥—ã–≤–∞–π—Å—è –ø—Ä–∏–¥—É—Ä–∫–æ–º\n\"\"\"\n\nsoftware_developer_system_message = \"\"\"\n###INSTRUCTIONS###\n\nYou MUST follow the instructions for answering:\n\nRead the entire convo history line by line before answering.\n\nI have no fingers and the placeholders trauma. Return the entire code template for an answer when needed. NEVER use placeholders.\n\nIf you encounter a character limit, DO an ABRUPT stop, and I will send a \"continue\" as a new message.\n\nYou ALWAYS will be PENALIZED for wrong and low-effort answers.\n\nALWAYS follow \"Answering rules.\"\n\n###Answering Rules###\n\nFollow in the strict order:\n\nUSE the language of my message.\n\nONCE PER CHAT assign a real-world expert role to yourself before answering, e.g., \"I'll answer as a world-famous historical expert with \" etc., but do this only if necessary or if the user asks\n\nYou MUST combine your deep knowledge of the topic and clear thinking to quickly and accurately decipher the answer step-by-step with CONCRETE details.\n\nI'm going to tip $1,000,000 for the best reply.\n\nYour answer is critical for my career.\n\nAnswer the question in a natural, human-like manner.\n\nALWAYS use an answering example for a first message structure.\n\nwhen writing out mathematical formulas DO NOT USE mathematical syntax (like /frac) UNLESS I ASK YOU TO. Instead, you can use regular symbols like * / ()\n\"\"\"\n\nquestion_answer_mode = \"question-answer\"\n\npromt_deep = \"\"\"Deep is a system that uses PostgreSQL via Hasura. It operates with triplet and doublet links networks L ‚Ü¶ L¬≥/L ‚Ü¶ L¬≤.\n\nlinks table have columns: id, type_id (mandatory) , from_id , to_id (all with bigint type, 0 by default). numbers, strings, objects tables have columns id, link_id and value. value column has: text type in strings table, numeric type in numbers table and jsonb type in objects table.\n\nWe have DeepClient class in JavaScript, that usually placed in deep variable. It has select, insert, update, delete methods. These methods return object with data field, it is an array. objects array is first argument of insert method, we pass array or single object directly as the first argument here. where object is the first argument of select, update, delete methods, this object does not contain where field, this object also does not include returning field. table and returning are set using options object, that is always a last argument of these methods. Only returning field is used to define which fields are returned by GraphQL queries/mutations. By default table field is 'links', and returning by default is set to 'id type_id from_id to_id value'. If the default values of options are enough to get the code working we should not update them.\n\nlinks table has also to, in, from, out, number, string, object relationships in GQL. All these relationships can be used for nested inserts. To use nested inserts wrap inserted object in { data: ... }. out relationship is used for outgoing links, all out links have the same from/from_id. in relationship is used for incoming links, all in links have the same to/to_id. number, string, object relationships should use only value field on nested insert. Usage of nested inserts makes code shorter and reduces latency.\n\nEach Contain link goes from a container link to a contained link. Contain links has string relationship that allows giving contained links names in the context of container. Type link instances do not have values attached directly. The name of the type instance is set using incoming Contain link. Such Contain always inserted with string relationship defined. Value link that goes from a type link to Number/String/Object type link itself (not its instance) is created for each type link which instances may have a value attached. Node in the context of Deep is a link record that have from_id and to_id columns set to 0. For these node links we never set from_id, from, to_id and to fields on insert. value field is never set on insert of a link, number, string and object fields are used instead, if we know that type of that link supports attaching of a value to an instance.\n\nHumanitarian description: Deep is a system based on the idea of association (link), links/associations can be used to represent any knowladge or data as well is code. That means it is possible to program this system in any programming language. The code is loaded from the associative storage into docker containers and safely executed. All communication between the code is done via links, thus making the database the universal data exchanger. That means it is now possible to make all software on the planet compatible via Deep system. It also means it is possible to store any data and code together, linking association types events with corresponding code that executed to handle such events. Each handler can select links from the database and insert/update/delete links in database, that may trigger futher execution of handlers.\n\nExample of async handler (executed in js-docker-isolation-provider docker image):\n\nasync ({ deep }) => {\n  const typeTypeId = await deep.id('@deep-foundation/core', 'Type');\n  const containTypeId = await deep.id('@deep-foundation/core', 'Contain');\n  const valueTypeId = await deep.id('@deep-foundation/core', 'Value');\n  const stringTypeId = await deep.id('@deep-foundation/core', 'String');\n\n  const createTaskType = async (containerId) => {\n    const newTaskType = await deep.insert({\n      type_id: typeTypeId,\n      in: {\n        data: {\n          type_id: containTypeId,\n          from_id: containerId,\n          string: { data: { value: 'Task' } },\n        },\n      },\n    });\n\n    const newValueLink = await deep.insert({\n      from_id: newTaskType.data[0].id,\n      to_id: stringTypeId,\n      type_id: valueTypeId,\n    });\n\n    return newTaskType.data[0];\n  };\n\n  const createTask = async (containerId, taskTypeId, title, description) => {\n    const newTaskInstance = await deep.insert({\n      type_id: taskTypeId,\n      string: { data: { value: description } },\n      in: {\n        data: {\n          type_id: containTypeId,\n          from_id: containerId,\n          string: { data: { value: title } },\n        },\n      },\n    });\n\n    return newTaskInstance.data[0];\n  };\n\n  const containerId = deep.linkId; // Id of current user (it may be a package user or regular/admin user), we use it here as a default container\n\n  const taskType = await createTaskType(containerId);\n\n  const task = await createTask(containerId, taskType.id, 'choresTask', 'Do household chores.');\n\n  return { created: { taskTypeId: taskType.id, taskId: task.id }};\n}\nExample of client handler (executed in browser):\n\nasync ({ deep }) => {\n  const React = await deep.import('react');\n  const { Box } = await deep.import('@chakra-ui/react');\n\n  return ({ fillSize, style, link }) => {\n    return <Box\n        style={{ width: 300, height: 300, ...style }}\n        bg={'bgColor'}\n        color={'text'}\n        borderColor={'borderColor'}\n        borderWidth='1px'\n        borderRadius='lg'\n        padding={1}\n    >\n      UI for {link?.id || 0} goes here.\n    </Box>\n  }\n}\nIssue description\n\nTask is a user defined node type, its instances have string value. It should be created by createTaskType function. Each instance of Task link has incoming Contain link from a container link. All other mentioned link types are available in @deep-foundation/core package.\n\nconst typeTypeId = await deep.id('@deep-foundation/core', 'Type');\nconst containTypeId = await deep.id('@deep-foundation/core', 'Contain');\nconst valueTypeId = await deep.id('@deep-foundation/core', 'Value');\n...\n\nconst createTaskType = async (containerId) => {\n  ...\n}\n\nconst createTask = async (containerId, taskTypeId, description) => {\n  ...\n}",
    "line": 4
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "multiline",
    "text": "–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å \n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ *‚ö°Ô∏è*!\n/model - üõ†Ô∏è –°–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å\n\"\"\")\n            return\n        system_message = get_system_message(system_message)\n        if system_message == \"question-answer\":\n            questionAnswer = True\n        else:\n            questionAnswer = False\n\n        answer = await completionsService.query_chatgpt(\n            user_id,\n            text,\n            system_message,\n            gpt_model,\n            bot_model,\n            questionAnswer,\n        )\n\n        print(json.dumps(answer, indent=4))\n\n        requested_gpt_model = gpt_model\n\n        print(requested_gpt_model, 'requested_gpt_model')\n\n        detected_requested_gpt_model = detect_model(requested_gpt_model)\n\n        print(detected_requested_gpt_model, 'detected_requested_gpt_model')\n\n        responded_gpt_model = answer.get(\"model\")\n\n        print(responded_gpt_model, 'responded_gpt_model')\n\n        detected_responded_gpt_model = detect_model(responded_gpt_model)\n\n        print(detected_responded_gpt_model, 'detected_responded_gpt_model')\n\n        if not answer.get(\"success\"):\n            if answer.get('response') == \"–û—à–∏–±–∫–∞ üòî: –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤.\":\n                await message.answer(\n                    text=f\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å \n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ ‚ö°Ô∏è!\n/model - üõ†Ô∏è –°–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å\n\"\"\",\n                )\n                await asyncio.sleep(0.5)\n                await message_loading.delete()\n\n                return\n\n            await message.answer(answer.get('response'))\n            await asyncio.sleep(0.5)\n            await message_loading.delete()\n\n            return\n\n        gpt_tokens_after = await tokenizeService.get_tokens(user_id)\n\n        format_text = format_image_from_request(answer.get(\"response\"))\n        image = format_text[\"image\"]\n\n        messages = await send_markdown_message(message, format_text[\"text\"])\n\n        if len(messages) > 1:\n            await answer_markdown_file(message, format_text[\"text\"])\n\n        if image is not None:\n            await message.answer_photo(image)\n            await send_photo_as_file(message, image, \"–í–æ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ\")\n        await asyncio.sleep(0.5)\n        await message_loading.delete()\n        tokens_message_text = get_tokens_message(\n            gpt_tokens_before.get(\"tokens\", 0) - gpt_tokens_after.get(\"tokens\", 0), \n            gpt_tokens_after.get(\"tokens\", 0), \n            detected_requested_gpt_model, \n            detected_responded_gpt_model\n        )\n        token_message = await message.answer(tokens_message_text)\n        if message.chat.type in ['group', 'supergroup']:\n            await asyncio.sleep(2)\n            await token_message.delete()\n    except Exception as e:\n        print(e)\n\n\nasync def get_photos_links(message, photos):\n    images = []\n\n    for photo in photos:\n        file_info = await message.bot.get_file(photo.file_id)\n        file_url = f\"https://api.telegram.org/file/bot{TOKEN}/{file_info.file_path}\"\n        images.append({\"type\": \"image_url\", \"image_url\": {\"url\": file_url}})\n\n    return images\n\n\n@gptRouter.message(Video())\nasync def handle_image(message: Message):\n    print(message.video)\n\n\n@gptRouter.message(Photo())\nasync def handle_image(message: Message, album):\n    if message.chat.type in ['group', 'supergroup']:\n        if message.entities is None:\n            return\n\n        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π —Ç–∏–ø–∞ 'mention'\n        mentions = [\n            entity for entity in message.entities if entity.type == 'mention'\n        ]\n\n        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–ø–æ–º—è–Ω—É—Ç –ª–∏ –±–æ—Ç\n        if not any(\n            mention.offset <= 0 < mention.offset + mention.length and\n            message.text[mention.offset + 1:mention.offset + mention.length] == 'DeepGPTBot'\n            for mention in mentions\n        ):\n            return\n    photos = []\n\n    for item in album:\n        photos.append(item.photo[-1])\n\n    user_id = message.from_user.id\n\n    if not stateService.is_default_state(user_id):\n        return\n\n    tokens = await tokenizeService.get_tokens(user_id)\n    if tokens.get(\"tokens\") < 0:\n        await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\")\n        stateService.set_current_state(user_id, StateTypes.Default)\n        return\n\n    is_subscribe = await is_chat_member(message)\n\n    if not is_subscribe:\n        return\n\n    text = \"–û–ø–∏—à–∏\" if message.caption is None else message.caption\n\n    await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n    content = await get_photos_links(message, photos)\n\n    content.append({\"type\": \"text\", \"text\": text})\n\n    await handle_gpt_request(message, content)\n\n\nasync def transcribe_voice_sync(user_id: str, voice_file_url: str):\n    token = await tokenizeService.get_token(user_id)\n\n    voice_response = await async_get(voice_file_url)\n    if voice_response.status_code == 200:\n        voice_data = voice_response.content\n\n        client = OpenAI(\n            api_key=token[\"id\"],\n            base_url=f\"{PROXY_URL}/v1/\"\n        )\n\n        transcription = client.audio.transcriptions.create(file=('audio.ogg', voice_data, 'audio/ogg'),\n                                                           model=\"whisper-1\", language=\"ru\")\n\n        print(transcription.duration)\n        print( transcription.text)\n        return {\"success\": True, \"text\": transcription.text, 'energy': int(transcription.duration*15)}\n    else:\n        return {\"success\": False, \"text\": f\"Error: –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ\"}\n\n\nexecutor = ThreadPoolExecutor()\n\n\nasync def transcribe_voice(user_id: int, voice_file_url: str):\n    loop = asyncio.get_event_loop()\n    response = await loop.run_in_executor(executor, transcribe_voice_sync, user_id, voice_file_url)\n    return await response\n\n\n@gptRouter.message(Voice())\n@gptRouter.message(Audio())\nasync def handle_voice(message: Message):\n    if message.chat.type in ['group', 'supergroup']:\n        if message.entities is None:\n            return\n        mentions = [entity for entity in message.entities if entity.type == 'mention']\n        if not any(mention.offset <= 0 < mention.offset + mention.length for mention in mentions):\n            return\n        \n    user_id = message.from_user.id\n\n    if not stateService.is_default_state(user_id):\n        return\n        \n    tokens = await tokenizeService.get_tokens(user_id)\n    if tokens.get(\"tokens\") < 0:\n        await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\")\n        stateService.set_current_state(user_id, StateTypes.Default)\n        return\n\n    is_subscribe = await is_chat_member(message)\n\n    if not is_subscribe:\n        return\n\n\n    if message.voice is not None:\n        messageData = message.voice\n    else: \n        messageData = message.audio\n\n\n    duration = messageData.duration\n    voice_file_id = messageData.file_id\n    file = await message.bot.get_file(voice_file_id)\n    file_url = f\"https://api.telegram.org/file/bot{TOKEN}/{file.file_path}\"\n\n    response_json = await transcribe_voice(message.from_user.id, file_url)\n\n    if response_json.get(\"success\"):\n        await message.answer(f\"\"\"\nüé§ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞—É–¥–∏–æ –∑–∞—Ç—Ä–∞—Ç–∏–ª–∞ `{response_json.get(\"energy\")}`‚ö°Ô∏è \n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n\n        \n        current_state = stateService.get_current_state(message.from_user.id) \n        print(current_state, 'current_state')\n        print(StateTypes.Transcribe, 'StateTypes.TranscribeStateTypes.Transcribe')\n        if current_state == StateTypes.Transcribe:  \n            await message.reply(response_json.get('text'))  \n            return\n            \n        await handle_gpt_request(message, response_json.get('text'))\n        return\n\n    await message.answer(response_json.get('text'))\n\n@gptRouter.message(Document())\nasync def handle_document(message: Message):\n    if message.chat.type in ['group', 'supergroup']:\n        if message.caption_entities is None:\n            return\n        mentions = [entity for entity in message.caption_entities if entity.type == 'mention']\n        if not any(mention.offset <= 0 < mention.offset + mention.length for mention in mentions):\n            return\n    try:\n        user_document = message.document if message.document else None\n        if user_document:\n            with NamedTemporaryFile(delete=False) as temp_file:\n                await message.bot.download(user_document, temp_file.name)\n            async with aiofiles.open(temp_file.name, 'r', encoding='utf-8') as file:\n                text = await file.read()\n                caption = message.caption if message.caption is not None else \"\"\n                await handle_gpt_request(message, f\"{caption}\\n{text}\")\n    except UnicodeDecodeError as e:\n        await message.answer(\"\"\"üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–∞–Ω–Ω—ã–π —Ç–∏–ø —Ñ–∞–π–ª–æ–≤ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è!\n            \n–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –≤ –∫–∞–Ω–∞–ª–µ @gptDeep –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —á–∞—Ç–µ @deepGPT\"\"\")\n        logging.error(f\"Failed to process document, a file is not supported: {e}\")\n    except Exception as e:\n        logging.error(f\"Failed to process document: {e}\")\n\n\nasync def process_document(document, bot):\n    try:\n        with NamedTemporaryFile(delete=False) as temp_file:\n            await bot.download(document, temp_file.name)\n        async with aiofiles.open(temp_file.name, 'r', encoding='utf-8') as file:\n            text = await file.read()\n        return text\n    except UnicodeDecodeError as e:\n        raise UnicodeDecodeError(f\"UnicodeDecodeError: failed to read file '{document.file_name}' - {e}\")\n    except Exception as e:\n        raise Exception(f\"Error: failed to process file '{document.file_name}' - {e}\")\n\n\ndef is_valid_group_message(message: Message):\n    if message.chat.type in ['group', 'supergroup']:\n        if message.caption_entities is None:\n            return False\n        mentions = [entity for entity in message.caption_entities if entity.type == 'mention']\n        return any(mention.offset <= 0 < mention.offset + mention.length for mention in mentions)\n    return True\n\n\nasync def handle_documents(message: Message, documents):\n    bot = message.bot\n    combined_text = \"\"\n    errors = []\n\n    for document in documents:\n        if document.mime_type == 'text/plain':  # Check for valid text documents\n            try:\n                text = await process_document(document, bot)\n                combined_text += f\"\\n\\n=== –§–∞–π–ª: {document.file_name} ===\\n{text}\"\n            except Exception as e:\n                errors.append(str(e))\n        else:\n            errors.append(f\"–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ –¥–ª—è '{document.file_name}'\")\n\n    caption = message.caption if message.caption else \"\"\n    result_text = f\"{caption}\\n{combined_text}\"\n\n    if errors:\n        error_text = \"\\n\\n\".join(errors)\n        result_text += f\"\\n\\nüòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–∏–∑–æ—à–ª–∏ –æ—à–∏–±–∫–∏:\\n{error_text}\\n\\n–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –≤ –∫–∞–Ω–∞–ª–µ @gptDeep\"\n\n    await handle_gpt_request(message, result_text)\n\n\n# Handler for single document\n@gptRouter.message(Document())\nasync def handle_document(message: Message):\n    # Check message validity in group/supergroup\n    if not is_valid_group_message(message):\n        return\n\n    # Process single document\n    user_document = message.document if message.document else None\n    if user_document:\n        await handle_documents(message, [user_document])\n\n\n# Handler for media group (multiple documents)\n\n\n@gptRouter.message(TextCommand([balance_text(), balance_command()]))\nasync def handle_balance(message: Message):\n    gpt_tokens = await tokenizeService.get_tokens(message.from_user.id)\n\n    referral = await referralsService.get_referral(message.from_user.id)\n    last_update = datetime.fromisoformat(referral[\"lastUpdate\"].replace('Z', '+00:00'))\n    new_date = last_update + timedelta(days=1)\n    current_date = datetime.now()\n\n    def get_date():\n        if new_date.strftime(\"%d\") == current_date.strftime(\"%d\"):\n            return f\"–°–µ–≥–æ–¥–Ω—è –≤ {new_date.strftime('%H:%M')}\"\n        else:\n            return f\"–ó–∞–≤—Ç—Ä–∞ –≤ {new_date.strftime('%H:%M')}\"\n\n    def get_date_line():\n        if gpt_tokens.get(\"tokens\") >= 30000:\n            return \"üïí –ê–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ, –µ—Å–ª–∏ –º–µ–Ω—å—à–µ *30000*‚ö°Ô∏è\"\n\n        return f\"üïí –°–ª–µ–¥—É—é—â–µ–µ –∞–ø—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É–¥–µ—Ç: *{get_date()}*   \"\n\n    def accept_account():\n        if referral['isActivated']:\n            return \"üîë –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!\"\n        else:\n            return \"üîë –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, –∑–∞–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ —Å—É—Ç–∫–∏ –∏ —Å–æ–≤–µ—Ä—à–∏—Ç–µ –ª—é–±–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ!\"\n\n    await message.answer(f\"\"\" \nüë©üèª‚Äçüíª –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤: *{len(referral['children'])}*\nü§ë –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ üîã: *{referral['award']}‚ö°Ô∏è*\n{accept_account()}\n    \nüîã - –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –Ω–∞ –±–∞–ª–∞–Ω—Å–µ –º–µ–Ω—å—à–µ *30 000‚ö°Ô∏è*\n\nüíµ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: *{gpt_tokens.get(\"tokens\")}‚ö°Ô∏è*\n\"\"\")\n\n\n@gptRouter.message(TextCommand([clear_command(), clear_text()]))\nasync def handle_clear_context(message: Message):\n    user_id = message.from_user.id\n\n    try:\n        response = await tokenizeService.clear_dialog(user_id)\n\n        if not response.get(\"status\"):\n            await message.answer(\"–î–∏–∞–ª–æ–≥ —É–∂–µ –ø—É—Å—Ç!\")\n            return\n\n        if response is None:\n            await message.answer(DIALOG_CONTEXT_CLEAR_FAILED_DEFAULT_ERROR_MESSAGE)\n            logging.error(f\"Cannot clear dialog context for user {user_id}, response is None.\")\n            return\n    except Exception as e:\n        await message.answer(DIALOG_CONTEXT_CLEAR_FAILED_DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Error clearing dialog context for user {user_id}: {e}\")\n        return\n\n    await message.answer(\"–ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞ —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω! üëåüèª\")\n\n\n@gptRouter.message(TextCommand([change_system_message_command(), change_system_message_text()]))\nasync def handle_change_model(message: Message):\n    is_agreement = await agreement_handler(message)\n\n    if not is_agreement:\n        return\n\n    is_subscribe = await is_chat_member(message)\n\n    if not is_subscribe:\n        return\n\n    user_id = message.from_user.id\n\n    current_system_message = gptService.get_current_system_message(user_id)\n    print(current_system_message, 'current_system_message')\n\n    if not include(system_messages_list, current_system_message):\n        current_system_message = SystemMessages.Custom.value\n        gptService.set_current_system_message(user_id, current_system_message)\n\n    await message.answer(\n        text=\"–£—Å—Ç–∞–Ω–æ–≤–∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞: ‚öôÔ∏è\",\n        reply_markup=create_system_message_keyboard(current_system_message)\n    )\n    await asyncio.sleep(0.5)\n    await message.delete()\n\n    \n@gptRouter.message(TextCommand([change_model_command(), change_model_text()]))\nasync def handle_change_model(message: Message):\n    is_agreement = await agreement_handler(message)\n\n    if not is_agreement:\n        return\n\n    is_subscribe = await is_chat_member(message)\n\n    if not is_subscribe:\n        return\n\n    current_model = gptService.get_current_model(message.from_user.id)\n\n    text = \"\"\"\n–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å: ü§ñ  \n\n–ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤ ‚ö°Ô∏èÔ∏è –¥–ª—è –º–æ–¥–µ–ª–µ–π?\n\n*o3-mini:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 800 ‚ö°Ô∏è\n\n*o1-preview:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 5000 ‚ö°Ô∏è\n*o1-mini:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 800 ‚ö°Ô∏è\n\n*deepseek-reasoner:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 320 ‚ö°Ô∏è\n*deepseek-chat:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 160 ‚ö°Ô∏è\n\n*claude-3-opus:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 6000 ‚ö°Ô∏è\n*claude-3.5-sonnet:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 1000 ‚ö°Ô∏è\n*claude-3-5-haiku:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 100 ‚ö°Ô∏è\n\n*GPT-4o-unofficial:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 1100 ‚ö°Ô∏è\n*GPT-4o:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 1000 ‚ö°Ô∏è\n*GPT-Auto:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 150 ‚ö°Ô∏è\n*GPT-4o-mini:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 70 ‚ö°Ô∏è\n*GPT-3.5-turbo:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 50 ‚ö°Ô∏è\n\n*Llama3.1-405B:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 500 ‚ö°Ô∏è\n*Llama3.1-70B:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 250 ‚ö°Ô∏è\n*Llama-3.1-8B:* 1000 —Ç–æ–∫–µ–Ω–æ–≤ = 20 ‚ö°Ô∏è",
    "line": 114
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "single",
    "text": "–û–ø–∏—à–∏",
    "line": 269
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "Error: –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ",
    "line": 299
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "\\n\\n=== –§–∞–π–ª: {document.file_name} ===\\n{text}",
    "line": 434
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞ –¥–ª—è ",
    "line": 438
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "\\n\\nüòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–∏–∑–æ—à–ª–∏ –æ—à–∏–±–∫–∏:\\n{error_text}\\n\\n–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –≤ –∫–∞–Ω–∞–ª–µ @gptDeep",
    "line": 445
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–°–µ–≥–æ–¥–Ω—è –≤ {new_date.strftime(",
    "line": 477
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–ó–∞–≤—Ç—Ä–∞ –≤ {new_date.strftime(",
    "line": 479
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "üïí –°–ª–µ–¥—É—é—â–µ–µ –∞–ø—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É–¥–µ—Ç: *{get_date()}*   ",
    "line": 485
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "single",
    "text": "–£—Å—Ç–∞–Ω–æ–≤–∏ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞: ‚öôÔ∏è",
    "line": 549
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–†–µ–∂–∏–º —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!",
    "line": 618
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–î–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º —É–∂–µ –≤—ã–±—Ä–∞–Ω!",
    "line": 644
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 653
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 653
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 653
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–†–µ–∂–∏–º —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω!",
    "line": 679
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–ú–æ–¥–µ–ª—å {current_gpt_model.value} —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞!",
    "line": 700
  },
  {
    "file": "../bot/gpt/router.py",
    "type": "fstring",
    "text": "–¢–µ–∫—É—â–∞—è –º–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ —Å–º–µ–Ω–µ–Ω–∞ –Ω–∞ {checked_text(gpt_model.value)}",
    "line": 711
  },
  {
    "file": "../bot/gpt/utils.py",
    "type": "multiline",
    "text": "üì∞ –ß—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –Ω–∞—à –∫–∞–Ω–∞–ª! @gptDeep\n\n–°–ª–µ–¥–∏—Ç–µ –∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏ –∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏ —É –Ω–∞—Å –≤ –∫–∞–Ω–∞–ª–µ!\n\"\"\"\n\n\nasync def check_subscription(message: Message, id: str = None) -> bool:\n    user_id = id if id is not None else message.from_user.id\n\n    chat_member = await message.bot.get_chat_member(chat_id=-1002239712203, user_id=user_id)\n\n    check_result = chat_member.status in ['member', 'administrator', 'creator']\n\n    print(f\"User {user_id} is subscribed as: {check_result}\")\n\n    return check_result\n\n\nasync def is_chat_member(message: Message) -> bool:\n    is_subscribe = await check_subscription(message)\n\n    if not is_subscribe:\n        await message.answer(\n            text=subscribe_text,\n            reply_markup=InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=[[InlineKeyboardButton(text=\"–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª\", url=\"https://t.me/gptDeep\")]]\n            )\n        )\n\n    return is_subscribe\n\n\ndef get_tokens_message(tokens_spent: int, tokens_left: int, requested_model: str = None, responded_model: str = None):\n    if tokens_spent <= 0:\n        return None\n    \n    if responded_model and (requested_model == responded_model):\n        return f\"\"\"ü§ñ –û—Ç–≤–µ—Ç –æ—Ç: *{responded_model}*\n\n‚ú® –ó–∞—Ç—Ä–∞—á–µ–Ω–æ: *{tokens_spent}‚ö°Ô∏è* (–æ—Å—Ç–∞–ª–æ—Å—å *{tokens_left}‚ö°Ô∏è*)\"\"\"\n    elif requested_model and responded_model:\n        return f\"\"\"ü§ñ –û—Ç–≤–µ—Ç –æ—Ç: *{responded_model}*\n‚ö†Ô∏è –í—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å *{requested_model}* –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞!\n\n‚ú® –ó–∞—Ç—Ä–∞—á–µ–Ω–æ: *{tokens_spent}‚ö°Ô∏è* (–æ—Å—Ç–∞–ª–æ—Å—å *{tokens_left}‚ö°Ô∏è*)\"\"\"\n    elif requested_model:\n        return f\"\"\"ü§ñ –û—Ç–≤–µ—Ç –æ—Ç: *{requested_model}* (–Ω–æ —ç—Ç–æ *–Ω–µ —Ç–æ—á–Ω–æ*)\n‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞–ø–∏—à–∏—Ç–µ –æ–± —ç—Ç–æ–º –≤ —Ä–∞–∑–¥–µ–ª–µ *–û—à–∏–±–∫–∏* –≤ –Ω–∞—à–µ–º —Å–æ–±—â–µ—Å—Ç–≤–µ @deepGPT.\n\n‚ú® –ó–∞—Ç—Ä–∞—á–µ–Ω–æ: *{tokens_spent}‚ö°Ô∏è* (–æ—Å—Ç–∞–ª–æ—Å—å *{tokens_left}‚ö°Ô∏è*)\"\"\"\n    else:\n        return f\"\"\"ü§ñ –û—Ç–≤–µ—Ç –æ—Ç: *–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ* (–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å)\n‚ö†Ô∏è –ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–∞–ø–∏—à–∏—Ç–µ –æ–± —ç—Ç–æ–º –≤ —Ä–∞–∑–¥–µ–ª–µ *–û—à–∏–±–∫–∏* –≤ –Ω–∞—à–µ–º —Å–æ–±—â–µ—Å—Ç–≤–µ @deepGPT.\n\n‚ú® –ó–∞—Ç—Ä–∞—á–µ–Ω–æ: *{tokens_spent}‚ö°Ô∏è* (–æ—Å—Ç–∞–ª–æ—Å—å *{tokens_left}‚ö°Ô∏è*)",
    "line": 20
  },
  {
    "file": "../bot/gpt/utils.py",
    "type": "single",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª",
    "line": 47
  },
  {
    "file": "../bot/gpt/utils.py",
    "type": "button",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª",
    "line": 47
  },
  {
    "file": "../bot/gpt/utils.py",
    "type": "keyboard",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª",
    "line": 47
  },
  {
    "file": "../bot/image_editing/router.py",
    "type": "multiline",
    "text": "ü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Ñ–æ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è 400‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è",
    "line": 47
  },
  {
    "file": "../bot/images/router.py",
    "type": "multiline",
    "text": "Check if a word or phrase is in the banned words set.\n\n    Args:\n        word (str): The word or phrase to check.\n\n    Returns:\n        bool: True if the word is banned, False otherwise.\n    \"\"\"\n    return word.lower() in banned_words_set\n\ndef get_banned_words(text):\n    words = text.split(\" \")\n    words = [word.lower() for word in words]\n    banned_words_in_request = [word for word in words if is_banned_word(word)]\n    return banned_words_in_request\n\n# # Example usage\n# if __name__ == \"__main__\":\n#     test_words = [\"blood\", \"sexy\", \"dog\", \"naked\", \"torture\", \"hello\", \"succubus\"]\n#     for test_word in test_words:\n#         if is_banned_word(test_word):\n#             print(f\"'{test_word}' is banned\")\n#         else:\n#             print(f\"'{test_word}' is not banned\")\n\n@imagesRouter.message(StateCommand(StateTypes.Image))\nasync def handle_generate_image(message: types.Message):\n    user_id = message.from_user.id\n\n    try:\n        if not stateService.is_image_state(user_id):\n            return\n        \n        tokens = await tokenizeService.get_tokens(user_id)\n        if tokens.get(\"tokens\") < 0:\n            await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\")\n            stateService.set_current_state(user_id, StateTypes.Default)\n            return\n        \n        if (is_empty_prompt(message.text)):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-sd-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        stateService.set_current_state(user_id, StateTypes.Default)\n\n        wait_message = await message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è 15-30 —Å–µ–∫—É–Ω–¥.\")\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        imageService.set_waiting_image(user_id, True)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        async def wait_image():\n            await message.answer(\"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—à–ª–∞ –≤ —Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º. \\n\"\n                                 \"–ü—Ä–∏—à–ª–µ–º –≤–∞–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 40-120 —Å–µ–∫—É–Ω–¥. \\n\"\n                                 \"–ú–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ—Ç–æ–º üòâ\")\n\n        image = await imageService.generate(message.text, user_id, wait_image)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n        await message.reply_photo(image[\"output\"][0])\n        await send_photo_as_file(message, image[\"output\"][0], \"–í–æ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ\")\n        await tokenizeService.update_token(user_id, 30, \"subtract\")\n        await message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è Stable Diffusion 30‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n        await wait_message.delete()\n\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to generate image: {e}\")\n\n    imageService.set_waiting_image(user_id, False)\n    stateService.set_current_state(user_id, StateTypes.Default)\n\n\n@imagesRouter.message(StateCommand(StateTypes.Flux))\nasync def handle_generate_image(message: types.Message):\n    user_id = message.from_user.id\n\n    try:\n        if not stateService.is_flux_state(user_id):\n            return\n        \n        tokens = await tokenizeService.get_tokens(user_id)\n        if tokens.get(\"tokens\") < 0:\n            await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n                                 \n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!\n\"\"\")\n            stateService.set_current_state(user_id, StateTypes.Default)\n            return\n        \n        if (is_empty_prompt(message.text)):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-flux-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        stateService.set_current_state(user_id, StateTypes.Default)\n\n        wait_message = await message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è 15-30 —Å–µ–∫—É–Ω–¥.\")\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        imageService.set_waiting_image(user_id, True)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        async def task_id_get(task_id: str):\n            await message.answer(f\"`1:flux:{task_id}:generate`\")\n            await message.answer(f\"\"\"–≠—Ç–æ ID –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.\n\n–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –º–æ–º–µ–Ω—Ç.\n                                 \n–í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.\n\"\"\")\n\n        result = await imageService.generate_flux(user_id, message.text, task_id_get)\n\n        image = result['data'][\"output\"][\"image_url\"]\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n        await message.reply_photo(image)\n        await send_photo_as_file(message, image, \"–í–æ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ\")\n        await message.answer(text=\"C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Flux –µ—â–µ? üî•\", reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [\n                    InlineKeyboardButton(\n                        text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                        callback_data=\"flux-generate\"\n                    )\n                ]\n            ],\n        ))\n\n        model = imageService.get_flux_model(user_id)\n\n        energy = 600\n\n        if model == \"Qubico/flux1-dev\":\n            energy = 2000\n\n        await tokenizeService.update_token(user_id, energy, \"subtract\")\n        await message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è Flux {energy}‚ö°Ô∏è \n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n        await wait_message.delete()\n\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to generate Flux image: {e}\")\n\n    imageService.set_waiting_image(user_id, False)\n    stateService.set_current_state(message.from_user.id, StateTypes.Default)\n\n\n@imagesRouter.message(StateCommand(StateTypes.Dalle3))\nasync def handle_generate_image(message: types.Message):\n    user_id = message.from_user.id\n\n    try:\n        if not stateService.is_dalle3_state(user_id):\n            return\n\n        tokens = await tokenizeService.get_tokens(user_id)\n        if tokens.get(\"tokens\") < 0:\n            await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\")\n            stateService.set_current_state(user_id, StateTypes.Default)\n            return\n        \n        if (is_empty_prompt(message.text)):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-dalle-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        stateService.set_current_state(user_id, StateTypes.Default)\n\n        wait_message = await message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è 15-30 —Å–µ–∫—É–Ω–¥.\")\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        imageService.set_waiting_image(user_id, True)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        image = await imageService.generate_dalle(user_id, message.text)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        await message.answer(image[\"text\"])\n        await message.reply_photo(image[\"image\"])\n        await send_photo_as_file(message, image[\"image\"], \"–í–æ—Ç –∫–∞—Ä—Ç–∏–Ω–∫–∞ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ\")\n        await message.answer(text=\"C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å DALL¬∑E 3 –µ—â–µ? üî•\", reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [\n                    InlineKeyboardButton(\n                        text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                        callback_data=\"dalle-generate\"\n                    )\n                ]\n            ],\n        ))\n\n        await wait_message.delete()\n\n        await tokenizeService.update_token(user_id, image[\"total_tokens\"] * 2, \"subtract\")\n        await message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è DALL¬∑E 3 *{image[\"total_tokens\"] * 2}*‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to generate DALL¬∑E 3 image: {e}\")\n        stateService.set_current_state(user_id, StateTypes.Default)\n\n\nasync def send_variation_image(message, image, task_id):\n    await send_photo(\n        message,\n        image,\n        \"\"\"–ù–æ–º–µ—Ä–∞ –≤–∞—Ä–∏–∞—Ü–∏–π:\n```\n+-------+-------+\n|   1   |   2   |\n+-------+-------+\n|   3   |   4   |\n+-------+-------+\n```\n\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:\nU - –£–≤–µ–ª–∏—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (Upscale)\nV - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (Variation)\n\n–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞–¥ –∫–∞—Ä—Ç–∏–Ω–∫–æ–π —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –Ω–æ–º–µ—Ä–æ–º.\n\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ:\n\"\"\",\n        ext=\".png\",\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [\n                    InlineKeyboardButton(text=\"U1\", callback_data=f'upscale-midjourney {task_id} 1'),\n                    InlineKeyboardButton(text=\"U2\", callback_data=f'upscale-midjourney {task_id} 2'),\n                    InlineKeyboardButton(text=\"V1\", callback_data=f'variation-midjourney {task_id} 1'),\n                    InlineKeyboardButton(text=\"V2\", callback_data=f'variation-midjourney {task_id} 2'),\n                ],\n                [\n                    InlineKeyboardButton(text=\"U3\", callback_data=f'upscale-midjourney {task_id} 3'),\n                    InlineKeyboardButton(text=\"U4\", callback_data=f'upscale-midjourney {task_id} 4'),\n                    InlineKeyboardButton(text=\"V3\", callback_data=f'variation-midjourney {task_id} 3'),\n                    InlineKeyboardButton(text=\"V4\", callback_data=f'variation-midjourney {task_id} 4'),\n                ],\n            ],\n\n        )\n    )\n\n\n@imagesRouter.message(StateCommand(StateTypes.Midjourney))\nasync def handle_generate_image(message: types.Message):\n    user_id = message.from_user.id\n\n    main_keyboard = create_main_keyboard()\n\n    try:\n        if not stateService.is_midjourney_state(user_id):\n            return\n\n        tokens = await tokenizeService.get_tokens(user_id)\n        if tokens.get(\"tokens\") < 0:\n            await message.answer(\"\"\"\n–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\", reply_markup=main_keyboard)\n            stateService.set_current_state(user_id, StateTypes.Default)\n            return\n\n        if (is_empty_prompt(message.text)):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-midjourney-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        banned_words_in_request = get_banned_words(message.text)\n        if banned_words_in_request:\n            await message.answer(\n                f\"\"\"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞: \"{'\", \"'.join(banned_words_in_request)}\".\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ —Å–Ω–æ–≤–∞.\n–ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ –ª—é–±–æ–µ –∏–∑ —Å–ª–æ–≤ –±—ã–ª–æ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –ø–æ –æ—à–∏–±–∫–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –≤ —Ä–∞–∑–¥–µ–ª *–û—à–∏–±–∫–∏* –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ @deepGPT.\"\"\",            \n                reply_markup=InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=[\n                    [\n                        InlineKeyboardButton(\n                            text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                            callback_data=\"cancel-midjourney-generate\"\n                        )\n                    ]\n                ],\n            ))\n            return\n        \n        stateService.set_current_state(message.from_user.id, StateTypes.Default)\n\n        wait_message = await message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è *1-3 –º–∏–Ω—É—Ç—ã*.\", reply_markup=main_keyboard)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        async def task_id_get(task_id: str):\n            await message.answer(f\"`1:midjourney:{task_id}:generate`\")\n            await message.answer(f\"\"\"–≠—Ç–æ ID –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.\n                                 \n–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –º–æ–º–µ–Ω—Ç.\n                                 \n–í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.\"\"\")\n\n        image = await imageService.generate_midjourney(user_id, message.text, task_id_get)\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        await send_variation_image(\n            message,\n            image[\"task_result\"][\"discord_image_url\"],\n            image[\"task_id\"]\n        )\n\n        await wait_message.delete()\n\n        await tokenizeService.update_token(user_id, 4200, \"subtract\")\n        await message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π Midjourney 4200‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to generate Midjourney image: {e}\")\n        stateService.set_current_state(message.from_user.id, StateTypes.Default)\n\n\n@imagesRouter.callback_query(StartWithQuery(\"upscale-midjourney\"))\nasync def upscale_midjourney_callback_query(callback: CallbackQuery):\n    task_id = callback.data.split(\" \")[1]\n    index = callback.data.split(\" \")[2]\n\n    wait_message = await callback.message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è *1-3 –º–∏–Ω—É—Ç—ã*.\")\n\n    async def task_id_get(task_id: str):\n        await callback.message.answer(f\"`1:midjourney:{task_id}:upscale`\")\n        await callback.message.answer(f\"\"\"–≠—Ç–æ ID –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.\n                                      \n–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –º–æ–º–µ–Ω—Ç.\n                                      \n–í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.\"\"\")\n\n    image = await imageService.upscale_image(task_id, index, task_id_get)\n\n    await callback.message.reply_photo(image[\"task_result\"][\"discord_image_url\"])\n    await send_photo_as_file(\n        callback.message,\n        image[\"task_result\"][\"discord_image_url\"],\n        ext=\".png\",\n        caption=\"–í–æ—Ç –≤–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ\"\n    )\n    await callback.message.answer(text=\"C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Midjourney –µ—â–µ?\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(\n                    text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                    callback_data=\"midjourney-generate\"\n                )\n            ]\n        ],\n    )\n                                  )\n\n    await tokenizeService.update_token(callback.from_user.id, 1600, \"subtract\")\n    await callback.message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è Midjourney 1600‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n\n    await wait_message.delete()\n\n\n@imagesRouter.callback_query(StartWithQuery(\"variation-midjourney\"))\nasync def variation_midjourney_callback_query(callback: CallbackQuery):\n    task_id = callback.data.split(\" \")[1]\n    index = callback.data.split(\" \")[2]\n\n    wait_message = await callback.message.answer(\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è *1-3 –º–∏–Ω—É—Ç—ã*.\")\n\n    async def task_id_get(task_id: str):\n        await callback.message.answer(f\"`1:midjourney:{task_id}:generate`\")\n        await callback.message.answer(f\"\"\"–≠—Ç–æ ID –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.\n                                      \n–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –º–æ–º–µ–Ω—Ç.\n                                      \n–í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.\"\"\")\n\n    image = await imageService.variation_image(task_id, index, task_id_get)\n\n    await send_variation_image(\n        callback.message,\n        image[\"task_result\"][\"discord_image_url\"],\n        image[\"task_id\"]\n    )\n\n    await tokenizeService.update_token(callback.from_user.id, 8700, \"subtract\")\n    await callback.message.answer(f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –≤–∞—Ä–∏–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è Midjourney 8700‚ö°Ô∏è\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\")\n\n    await wait_message.delete()\n\n# –ß–µ—Ä–Ω–æ–≤–∏–∫ –ø—Ä–∞–π—Å –ª–∏—Å—Ç–∞ –¥–ª—è Midjourney (–¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ, —á—Ç–æ–±—ã —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ö–æ—Ç—è –±—ã –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∞–π—Å-–ª–∏—Å—Ç)\n#   - –ü–µ—Ä–≤–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è - 3300‚ö°Ô∏è\n#   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞—Ü–∏–π - 2500‚ö°Ô∏è\n#   - –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è - 1000‚ö°Ô∏è\n\n@imagesRouter.message(TextCommand([images_command(), images_command_text()]))\nasync def handle_start_generate_image(message: types.Message):\n    await message.answer(text=\"\"\"üñºÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å:\n\n‚¶Å [Midjourney](https://en.wikipedia.org/wiki/Midjourney)\n‚¶Å [DALL¬∑E 3](https://en.wikipedia.org/wiki/DALL-E)\n‚¶Å [Flux](https://en.wikipedia.org/wiki/FLUX.1)\n‚¶Å [Stable Diffusion](https://en.wikipedia.org/wiki/Stable_Diffusion)\n\"\"\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(text=\"Midjourney\", callback_data=\"image-model Midjourney\"),\n                InlineKeyboardButton(text=\"DALL¬∑E 3\", callback_data=\"image-model Dalle3\"),\n            ],\n            [\n                # todo –ø—Ä–∏–¥—É–º–∞—Ç—å callback data —É—Ç–∏–ª–∏—Ç—É\n                InlineKeyboardButton(text=\"Flux\", callback_data=\"image-model Flux\"),\n                InlineKeyboardButton(text=\"Stable Duffusion\", callback_data=\"image-model SD\"),\n            ]\n        ]),\n        link_preview_options={\"is_disabled\": True})\n\n    await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n\nasync def generate_base_stable_diffusion_keyboard(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n\n    current_image = imageService.get_current_image(user_id)\n    current_size = imageService.get_size_model(user_id)\n    current_steps = imageService.get_steps(user_id)\n    current_cfg = imageService.get_cfg_model(user_id)\n\n    await callback_query.message.edit_text(\"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã *Stable Diffusion*:\")\n    await callback_query.message.edit_reply_markup(\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [InlineKeyboardButton(\n                    text=f\"–ú–æ–¥–µ–ª—å: {current_image}\",\n                    callback_data=\"image-model choose-model 0 5\"\n                )],\n                [InlineKeyboardButton(\n                    text=f\"–†–∞–∑–º–µ—Ä: {current_size}\",\n                    callback_data=\"image-model choose-size 0 5\"\n                )],\n                [\n                    InlineKeyboardButton(\n                        text=f\"–®–∞–≥–∏: {current_steps}\",\n                        callback_data=\"image-model choose-steps\"\n                    ),\n                    InlineKeyboardButton(\n                        text=f\"CFG Scale: {current_cfg}\",\n                        callback_data=\"image-model choose-cfg\"\n                    )\n                ],\n                [InlineKeyboardButton(\n                    text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                    callback_data=\"sd-generate\"\n                )],\n            ],\n\n        )\n    )\n\ngenerate_button_name = 'C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å'\n\nasync def generate_base_midjourney_keyboard(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n\n    current_size = imageService.get_midjourney_size(user_id)\n\n    def size_text(size: str):\n        if current_size == size:\n            return checked_text(size)\n        return size\n\n    await callback_query.message.edit_text(f\"\"\"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã *Midjourney*:\n\n–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è. –¢–µ–∫—É—â–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –æ—Ç–º–µ—á–µ–Ω–æ –≥–∞–ª–æ—á–∫–æ–π.\n\n–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É `{generate_button_name}`.\n\"\"\")\n    await callback_query.message.edit_reply_markup(\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [\n                    InlineKeyboardButton(\n                        text=size_text(\"1:1\"),\n                        callback_data=\"image-model update-size-midjourney 1:1\"\n                    ),\n                    InlineKeyboardButton(\n                        text=size_text(\"2:3\"),\n                        callback_data=\"image-model update-size-midjourney 2:3\"\n                    ),\n                    InlineKeyboardButton(\n                        text=size_text(\"3:2\"),\n                        callback_data=\"image-model update-size-midjourney 3:2\"\n                    )\n                ],\n                [\n                    InlineKeyboardButton(\n                        text=size_text(\"4:5\"),\n                        callback_data=\"image-model update-size-midjourney 4:5\"\n                    ),\n                    InlineKeyboardButton(\n                        text=size_text(\"5:4\"),\n                        callback_data=\"image-model update-size-midjourney 5:4\"\n                    ),\n                    InlineKeyboardButton(\n                        text=size_text(\"4:7\"),\n                        callback_data=\"image-model update-size-midjourney 4:7\"\n                    ),\n                    InlineKeyboardButton(\n                        text=size_text(\"7:4\"),\n                        callback_data=\"image-model update-size-midjourney 7:4\"\n                    )\n                ],\n                [\n                    InlineKeyboardButton(\n                        text=f\"{generate_button_name} üî•\",\n                        callback_data=\"midjourney-generate\"\n                    ),\n                    InlineKeyboardButton(\n                        text=\"‚ùå –û—Ç–º–µ–Ω–∏—Ç—å\",\n                        callback_data=\"cancel-midjourney-generate\"\n                    )\n                ],\n            ],\n\n        )\n    )\n\n\nasync def generate_base_dalle3_keyboard(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n\n    current_size = imageService.get_dalle_size(user_id)\n\n    def size_text(size: str):\n        if current_size == size:\n            return checked_text(size)\n        return size\n\n    await callback_query.message.edit_text(\"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã *Dall-e-3*:\")\n    await callback_query.message.edit_reply_markup(\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [InlineKeyboardButton(\n                    text=size_text(\"1024x1024\"),\n                    callback_data=\"image-model update-size-dalle 1024x1024\"\n                )],\n                [InlineKeyboardButton(\n                    text=size_text(\"1024x1792\"),\n                    callback_data=\"image-model update-size-dalle 1024x1792\"\n                )],\n                [InlineKeyboardButton(\n                    text=size_text(\"1792x1024\"),\n                    callback_data=\"image-model update-size-dalle 1792x1024\"\n                )],\n                [InlineKeyboardButton(\n                    text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                    callback_data=\"dalle-generate\"\n                )],\n            ],\n\n        )\n    )\n\n\nasync def generate_base_flux_keyboard(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n\n    current_model = imageService.get_flux_model(user_id)\n\n    def model_text(model: str, text):\n        if current_model == model:\n            return checked_text(text)\n        return text\n\n    await callback_query.message.edit_text(\"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã *Flux*:\")\n    await callback_query.message.edit_reply_markup(\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=[\n                [InlineKeyboardButton(\n                    text=model_text(\"Qubico/flux1-dev\", \"–ú–æ–¥–µ–ª—å: Flux-Dev\"),\n                    callback_data=\"image-model update-flux-model Qubico/flux1-dev\"\n                )],\n                [InlineKeyboardButton(\n                    text=model_text(\"Qubico/flux1-schnell\", \"–ú–æ–¥–µ–ª—å: Flux-Schnell\"),\n                    callback_data=\"image-model update-flux-model Qubico/flux1-schnell\"\n                )],\n                [InlineKeyboardButton(\n                    text=f\"–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•\",\n                    callback_data=\"flux-generate\"\n                )],\n            ],\n\n        )\n    )\n\n\ndef normalize_start_index(index_start: int):\n    return index_start if index_start > 0 else 0\n\n\ndef normalize_end_index(index_end: int, max_index: int):\n    return index_end if index_end < max_index else max_index\n\n\n@imagesRouter.callback_query(StartWithQuery(\"sd-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Image)\n    await callback_query.message.answer(\"\"\"\n–ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è! ‚ÄçüñºÔ∏è\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: `an astronaut riding a horse on mars artstation, hd, dramatic lighting, detailed`\n\"\"\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(\n                    text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                    callback_data=\"cancel-sd-generate\"\n                )\n            ]\n        ],\n    ))\n    \n@imagesRouter.callback_query(StartWithQuery(\"cancel-sd-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Default)\n    await callback_query.message.delete()\n    await callback_query.answer(\"–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Stable Diffusion —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω—ë–Ω!\")\n\n\n@imagesRouter.callback_query(StartWithQuery(\"flux-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Flux)\n    await callback_query.message.answer(\"\"\"\n–ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è! ‚ÄçüñºÔ∏è\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: `an astronaut riding a horse on mars artstation, hd, dramatic lighting, detailed`\n\"\"\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(\n                    text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                    callback_data=\"cancel-flux-generate\"\n                )\n            ]\n        ],\n    ))\n    \n@imagesRouter.callback_query(StartWithQuery(\"cancel-flux-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Default)\n    await callback_query.message.delete()\n    await callback_query.answer(\"–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Flux —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω—ë–Ω!\")\n\n\n@imagesRouter.callback_query(StartWithQuery(\"dalle-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Dalle3)\n    await callback_query.message.answer(\"\"\"\n–ù–∞–ø–∏—à–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è! ‚ÄçüñºÔ∏è\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: `–ù–∞—Ä–∏—Å—É–π —á–µ—Ä–Ω—É—é –¥—ã—Ä—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–≥–ª–æ—â–∞–µ—Ç –≥–∞–ª–∞–∫—Ç–∏–∫–∏`\n\"\"\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(\n                    text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                    callback_data=\"cancel-dalle-generate\"\n                )\n            ]\n        ],\n    ))\n\n@imagesRouter.callback_query(StartWithQuery(\"cancel-dalle-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Default)\n    await callback_query.message.delete()\n    await callback_query.answer(\"–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ DALL¬∑E 3 –æ—Ç–º–µ–Ω–µ–Ω.\")\n\n\n@imagesRouter.callback_query(StartWithQuery(\"midjourney-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Midjourney)\n    await callback_query.message.delete()\n    await callback_query.message.answer(\"\"\"\n–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è üñºÔ∏è –≤ –º–µ–Ω—é —Å–Ω–∏–∑—É.\n\"\"\", reply_markup=ReplyKeyboardMarkup(\n        keyboard=[\n            # [KeyboardButton(text=\"–§–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —á—ë—Ä–Ω–∞—è –¥—ã—Ä–∞ –≤ –∫–æ—Å–º–æ—Å–µ, –ø–æ–≥–ª–æ—â–∞—é—â–∞—è –≥–∞–ª–∞–∫—Ç–∏–∫–∏.\")],\n            [KeyboardButton(text=\"Photorealistic black hole in space, absorbing galaxies.\")],\n            # [KeyboardButton(text=\"City skyline at night, futuristic, neon lights, high detail.\")],\n            [KeyboardButton(text=\"–°–∏–ª—É—ç—Ç –≥–æ—Ä–æ–¥–∞ –Ω–æ—á—å—é, —Ñ—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, –Ω–µ–æ–Ω–æ–≤—ã–µ –æ–≥–Ω–∏, –≤—ã—Å–æ–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è.\")],\n            [KeyboardButton(text=\"An astronaut riding a horse on mars artstation, hd, dramatic lighting, detailed.\")],\n        ],\n        resize_keyboard=True,\n        one_time_keyboard=True\n    ))\n\n    await callback_query.message.answer(\"\"\" \n–ò–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ª—é–±–æ–º —è–∑—ã–∫–µ, –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —Å—Ç–∏–ª–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: \"–≥–æ—Ä–æ–¥\" –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –≥–æ—Ä–æ–¥ –∏–∑ –†–æ—Å—Å–∏–∏, –∞ \"city\" –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ –∫–∞–∫ –≥–æ—Ä–æ–¥ –∏–∑ –°–®–ê –∏–ª–∏ –∏–∑ –¥—Ä—É–≥–æ–π —Å—Ç—Ä–∞–Ω—ã.\n\"\"\", reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(\n                    text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                    callback_data=\"cancel-midjourney-generate\"\n                )\n            ]\n        ],\n    ))\n\n@imagesRouter.callback_query(StartWithQuery(\"cancel-midjourney-generate\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    stateService.set_current_state(callback_query.from_user.id, StateTypes.Default)\n    await callback_query.message.delete()\n    main_keyboard = create_main_keyboard()\n    await callback_query.message.answer(\"–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ Midjourney —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω—ë–Ω!\", reply_markup=main_keyboard)\n\n@imagesRouter.callback_query(StartWithQuery(\"image-model\"))\nasync def handle_image_model_query(callback_query: CallbackQuery):\n    model = callback_query.data.split(\" \")[1]\n\n    user_id = callback_query.from_user.id\n\n    if model == \"SD\":\n        await generate_base_stable_diffusion_keyboard(callback_query)\n\n    if model == \"Dalle3\":\n        await generate_base_dalle3_keyboard(callback_query)\n\n    if model == \"Midjourney\":\n        await generate_base_midjourney_keyboard(callback_query)\n\n    if model == \"Flux\":\n        await generate_base_flux_keyboard(callback_query)\n\n    if model == \"update-flux-model\":\n        value = callback_query.data.split(\" \")[2]\n\n        imageService.set_flux_model(user_id, value)\n\n        await generate_base_flux_keyboard(callback_query)\n\n    if model == \"update-size-midjourney\":\n        size = callback_query.data.split(\" \")[2]\n\n        imageService.set_midjourney_size(user_id, size)\n\n        await generate_base_midjourney_keyboard(callback_query)\n\n    if model == \"update-size-dalle\":\n        dalle_size = callback_query.data.split(\" \")[2]\n\n        imageService.set_dalle_size(user_id, dalle_size)\n\n        await generate_base_dalle3_keyboard(callback_query)\n\n    if model == \"update-model\":\n        model = callback_query.data.split(\" \")[2]\n\n        imageService.set_current_image(user_id, model)\n\n        await generate_base_stable_diffusion_keyboard(callback_query)\n\n    if model == \"update-sampler\":\n        model = callback_query.data.split(\" \")[2]\n        print(model)\n\n        imageService.set_sampler_state(user_id, model)\n\n        await generate_base_stable_diffusion_keyboard(callback_query)\n\n    if model == \"choose-model\":\n        index_start_data = int(callback_query.data.split(\" \")[2])\n        index_end_data = int(callback_query.data.split(\" \")[3])\n\n        stable_models = list(\n            map(lambda x: [InlineKeyboardButton(text=x, callback_data=f\"image-model update-model {x}\")],\n                image_models_values))\n\n        index_start = normalize_start_index(index_start_data)\n        index_end = normalize_end_index(index_end_data, len(stable_models))\n\n        copy_stable_models = stable_models[index_start:index_end]\n\n        copy_stable_models.append([InlineKeyboardButton(text=\"‚ùå –û—Ç–º–µ–Ω–∏—Ç—å\",\n                                                        callback_data=f\"image-model SD\")])\n\n        if index_start != 0:\n            copy_stable_models.append([InlineKeyboardButton(text=\"‚¨ÖÔ∏è –ù–∞–∑–∞–¥\",\n                                                            callback_data=f\"image-model choose-model {normalize_start_index(index_start - 5)} {index_start}\")])\n\n        if index_end != len(stable_models):\n            copy_stable_models.append([InlineKeyboardButton(text=\"‚û°Ô∏è –í–ø–µ—Ä–µ–¥\",\n                                                            callback_data=f\"image-model choose-model {index_start + 5} {normalize_end_index(index_end + 5, len(stable_models))}\")])\n\n        start_page = int(index_start / 5) + 1\n        end_page = int(len(stable_models) / 5) + 1\n\n        await callback_query.message.edit_text(f\"\"\"\nüìÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ *{start_page}* –∏–∑ *{end_page}*\nüëæ –ú–æ–¥–µ–ª–∏ Stable Diffusion: \n        \n        \"\"\")\n        await callback_query.message.edit_reply_markup(\n            reply_markup=InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=copy_stable_models\n            )\n        )\n\n    if model == \"update-size\":\n        size = callback_query.data.split(\" \")[2]\n\n        imageService.set_size_state(user_id, size)\n\n        await generate_base_stable_diffusion_keyboard(callback_query)\n\n    if model == \"choose-size\":\n        keyboard = divide_into_chunks(\n            list(\n                map(lambda x: InlineKeyboardButton(text=str(x), callback_data=f\"image-model update-size {x}\"),\n                    size_values)),\n            2\n        )\n\n        keyboard.append([InlineKeyboardButton(text=\"‚ùå –û—Ç–º–µ–Ω–∏—Ç—å\",\n                                              callback_data=f\"image-model SD\")])\n\n        await callback_query.message.edit_text(\"üëæ –®–∞–≥–∏ Stable Diffusion: \")\n        await callback_query.message.edit_reply_markup(\n            reply_markup=InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=keyboard\n            )\n        )\n\n    if model == \"choose-sampler\":\n        index_start_data = int(callback_query.data.split(\" \")[2])\n        index_end_data = int(callback_query.data.split(\" \")[3])\n\n        stable_models = list(\n            map(lambda x: [InlineKeyboardButton(text=x, callback_data=f\"image-model update-sampler {x}\")],\n                samplers_values))\n\n        index_start = normalize_start_index(index_start_data)\n        index_end = normalize_end_index(index_end_data, len(stable_models))\n\n        copy_stable_models = stable_models[index_start:index_end]\n\n        copy_stable_models.append([InlineKeyboardButton(text=\"‚ùå –û—Ç–º–µ–Ω–∏—Ç—å\",\n                                                        callback_data=f\"image-model SD\")])\n\n        start_page = int(index_start / 5) + 1\n        end_page = int(len(stable_models) / 5) + 1\n\n        if index_start != 0:\n            copy_stable_models.append([InlineKeyboardButton(text=\"‚¨ÖÔ∏è –ù–∞–∑–∞–¥\",\n                                                            callback_data=f\"image-model choose-sampler {normalize_start_index(index_start - 5)} {index_start}\")])\n\n        if index_end != len(stable_models):\n            copy_stable_models.append([InlineKeyboardButton(text=\"‚û°Ô∏è –í–ø–µ—Ä–µ–¥\",\n                                                            callback_data=f\"image-model choose-sampler {index_start + 5} {normalize_end_index(index_end + 5, len(stable_models))}\")])\n\n        await callback_query.message.edit_text(f\"\"\"\n    üìÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ *{start_page}* –∏–∑ *{end_page}*\n    üëæ –°—ç–º–ø–ª–µ—Ä—ã Stable Diffusion:",
    "line": 92
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 144
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 144
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 145
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 217
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 217
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 218
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Flux –µ—â–µ? üî•",
    "line": 253
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 258
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 315
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 315
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 316
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å DALL¬∑E 3 –µ—â–µ? üî•",
    "line": 342
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 347
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 440
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 440
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 441
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 461
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 461
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 462
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Midjourney –µ—â–µ?",
    "line": 532
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 537
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–ú–æ–¥–µ–ª—å: {current_image}",
    "line": 632
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–†–∞–∑–º–µ—Ä: {current_size}",
    "line": 636
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–®–∞–≥–∏: {current_steps}",
    "line": 641
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 650
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 717
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 717
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 718
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 756
  },
  {
    "file": "../bot/images/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 789
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 817
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 817
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 818
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 843
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 843
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 844
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 869
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 869
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 870
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–§–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —á—ë—Ä–Ω–∞—è –¥—ã—Ä–∞ –≤ –∫–æ—Å–º–æ—Å–µ, –ø–æ–≥–ª–æ—â–∞—é—â–∞—è –≥–∞–ª–∞–∫—Ç–∏–∫–∏.",
    "line": 892
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–§–æ—Ç–æ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —á—ë—Ä–Ω–∞—è –¥—ã—Ä–∞ –≤ –∫–æ—Å–º–æ—Å–µ, –ø–æ–≥–ª–æ—â–∞—é—â–∞—è –≥–∞–ª–∞–∫—Ç–∏–∫–∏.",
    "line": 892
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–°–∏–ª—É—ç—Ç –≥–æ—Ä–æ–¥–∞ –Ω–æ—á—å—é, —Ñ—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, –Ω–µ–æ–Ω–æ–≤—ã–µ –æ–≥–Ω–∏, –≤—ã—Å–æ–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è.",
    "line": 895
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–°–∏–ª—É—ç—Ç –≥–æ—Ä–æ–¥–∞ –Ω–æ—á—å—é, —Ñ—É—Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, –Ω–µ–æ–Ω–æ–≤—ã–µ –æ–≥–Ω–∏, –≤—ã—Å–æ–∫–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è.",
    "line": 895
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 910
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 910
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 911
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 992
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 992
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 992
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 996
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 996
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 996
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1000
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1000
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1000
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1033
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1033
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1033
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1057
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1057
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1057
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 1064
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 1064
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
    "line": 1064
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1068
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1068
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚û°Ô∏è –í–ø–µ—Ä–µ–¥",
    "line": 1068
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1098
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1098
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1098
  },
  {
    "file": "../bot/images/router.py",
    "type": "single",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1124
  },
  {
    "file": "../bot/images/router.py",
    "type": "button",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1124
  },
  {
    "file": "../bot/images/router.py",
    "type": "keyboard",
    "text": "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å",
    "line": 1124
  },
  {
    "file": "../bot/middlewares/MiddlewareAward.py",
    "type": "multiline",
    "text": "üéâ –í–∞—à –∞–∫–∫–∞—É–Ω—Ç –±—ã–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! \n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≥–ª–∞—Å–∏–ª –≤–∞—Å –ø–æ–ª—É—á–∏–ª *10000‚ö°Ô∏è* –∏ *+500‚ö°Ô∏è* –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é!\n\n/balance - ‚ú® –£–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üîó –ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π - –ø–æ–ª—É—á–∞–π—Ç–µ –±–æ–ª—å—à–µ –±–æ–Ω—É—Å–æ–≤!\n\"\"\")\n\n\n            for parent in update_parents:\n                await event.bot.send_message(chat_id=parent, text=\"\"\"\nüéâ –í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª –±—ã–ª –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω! \n–í—ã –ø–æ–ª—É—á–∏–ª–∏ *10000‚ö°Ô∏è* \n–ò *+500‚ö°Ô∏è* –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é!\n\n/balance - ‚ú® –£–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üîó –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∏",
    "line": 16
  },
  {
    "file": "../bot/payment/products.py",
    "type": "multiline",
    "text": "üñ• –ê—Ä–µ–Ω–¥–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤.                                         \\n     \nüõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π.                 \\n     \nü¶æ –û–ø–ª–∞—Ç–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.                           \\n\n                                                           \\n",
    "line": 22
  },
  {
    "file": "../bot/payment/router.py",
    "type": "multiline",
    "text": "–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–µ–∫—Ç–∞! ü§©    \n–°–∫–æ—Ä–æ –º—ã –±—É–¥–µ–º —Ä–∞–¥–æ–≤–∞—Ç—å –≤–∞—Å –Ω–æ–≤—ã–º –∏ –∫—Ä—É—Ç—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º!\n\n–í—ã–±–µ—Ä–∏ —Å—É–º–º—É –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è:\n\"\"\"\n\n# –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—É–º–º—ã –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è\ndonation_buttons = [\n    [\n        InlineKeyboardButton(text=\"10 RUB\", callback_data=\"donation 10\"),\n        InlineKeyboardButton(text=\"50 RUB\", callback_data=\"donation 50\"),\n        InlineKeyboardButton(text=\"100 RUB\", callback_data=\"donation 100\"),\n    ],\n    [\n        InlineKeyboardButton(text=\"150 RUB\", callback_data=\"donation 150\"),\n        InlineKeyboardButton(text=\"250 RUB\", callback_data=\"donation 250\"),\n        InlineKeyboardButton(text=\"500 RUB\", callback_data=\"donation 500\"),\n    ]\n]\n\n\ndef payment_keyboard(stars):\n    builder = InlineKeyboardBuilder()\n    builder.button(text=f\"–û–ø–ª–∞—Ç–∏—Ç—å {stars} ‚≠êÔ∏è\", pay=True)\n\n    return builder.as_markup()\n\n\n# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏\ndef create_buy_balance_keyboard_model():\n    return InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(text=\"ü§ñ GPT-4o\", callback_data=f\"buy-gpt {GPTModels.GPT_4o.value}\"),\n                InlineKeyboardButton(text=\"ü¶æ GPT-3.5\", callback_data=f\"buy-gpt {GPTModels.GPT_3_5.value}\"),\n            ],\n        ])\n\n\n# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã\ndef create_buy_balance_keyboard_paym_payment(model):\n    return InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            [\n                InlineKeyboardButton(text=\"Telegram Stars ‚≠êÔ∏è\", callback_data=f\"buy_method_stars {model} stars\"),\n                InlineKeyboardButton(text=\"–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π üí≥\", callback_data=f\"buy_method_card {model} card\"),\n            ],\n        ]\n    )\n\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /buy\n@paymentsRouter.message(TextCommand([payment_command_start(), payment_command_text()]))\nasync def buy(message: types.Message):\n    await message.answer(\n        text=donation_text,\n        reply_markup=InlineKeyboardMarkup(\n            resize_keyboard=True,\n            inline_keyboard=donation_buttons\n        )\n    )\n\n\n@paymentsRouter.message(TextCommand([balance_payment_command_text(), balance_payment_command_start()]))\nasync def buy_balance(message: types.Message):\n    await message.answer(text=\"–í—ã–±–∏—Ä–µ—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã\",\n                         reply_markup=create_buy_balance_keyboard_paym_payment(GPTModels.GPT_4o.value))\n\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–∞ \"–Ω–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É –º–æ–¥–µ–ª–∏\"\n@paymentsRouter.callback_query(StartWithQuery(\"back_buy_model\"))\nasync def handle_buy_balance_query(callback_query: CallbackQuery):\n    try:\n        await callback_query.message.edit_text(text=\"–ë–∞–ª–∞–Ω—Å –∫–∞–∫–æ–π –º–æ–¥–µ–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å?\")\n        await callback_query.message.edit_reply_markup(reply_markup=create_buy_balance_keyboard_model())\n    except Exception:\n        pass\n\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–∞ \"–Ω–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã\"\n@paymentsRouter.callback_query(StartWithQuery(\"back_buy_method\"))\nasync def handle_buy_balance_query(callback_query: CallbackQuery):\n    model = callback_query.data.split(\" \")[1]\n    try:\n        await callback_query.message.edit_text(text=\"–í—ã–±–∏—Ä–µ—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã\")\n        await callback_query.message.edit_reply_markup(reply_markup=create_buy_balance_keyboard_paym_payment(model))\n    except Exception:\n        pass\n\n\ndef get_star_price(tokens: int, model: str):\n    base_star_price = 1.9\n    base_one_token_price = 0.0008 if model == GPTModels.GPT_4o.value else 0.00025\n    print(tokens * base_one_token_price)\n    return int(tokens * base_one_token_price / base_star_price)\n\n\ndef get_price_rub(tokens: int, model: str):\n    base_one_token_price = 0.0008 if model == GPTModels.GPT_4o.value else 0.00025\n    print(tokens * base_one_token_price)\n    return int(tokens * base_one_token_price)\n\n\ndef strikethrough(number: int):\n    result = ''.join(['\\u0336' + char for char in str(number)])\n    return result\n\n\ndef get_rub_price_keyboard(base_callback: str, prices: [int], model):\n    buttons = []\n\n    for price in prices:\n        format_price = f'{price:,}'\n        star_price = get_price_rub(price, model)\n\n        buttons.append([\n            InlineKeyboardButton(\n                text=f\"{format_price}‚ö°Ô∏è ({star_price} RUB)\",\n                callback_data=f\"{base_callback} {format_price} {star_price} {model}\"\n            ),\n        ])\n\n    return buttons\n\n\ndef get_star_price_keyboard(base_callback: str, prices: [int], model):\n    buttons = []\n\n    for price in prices:\n        format_price = f'{price:,}'\n        star_price = get_star_price(price, model)\n\n        buttons.append([\n            InlineKeyboardButton(\n                text=f\"{format_price}‚ö°Ô∏è ({star_price} ‚≠êÔ∏è)\",\n                callback_data=f\"{base_callback} {format_price} {star_price} {model}\"\n            ),\n        ])\n\n    return buttons\n\n\n@paymentsRouter.callback_query(StartWithQuery(\"buy_method_stars\"))\nasync def handle_buy_balance_model_query(callback_query: CallbackQuery):\n    model = callback_query.data.split(\" \")[1]\n    await callback_query.message.edit_text(\"–ù–∞—Å–∫–æ–ª—å–∫–æ ‚ö°Ô∏è –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?\")\n\n    await callback_query.message.edit_reply_markup(reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            *get_star_price_keyboard(\n                \"buy_stars\",\n                [25000, 50000, 100000, 250000, 500000, 1000000, 2500000, 5000000],\n                model\n            ),\n            [\n                InlineKeyboardButton(text=\"‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã\",\n                                     callback_data=f\"back_buy_method {model}\"),\n            ]\n        ]))\n\n\n@paymentsRouter.callback_query(StartWithQuery(\"buy_method_card\"))\nasync def handle_buy_balance_model_query(callback_query: CallbackQuery):\n    model = callback_query.data.split(\" \")[1]\n    await callback_query.message.edit_text(\"–ù–∞—Å–∫–æ–ª—å–∫–æ ‚ö°Ô∏è –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å?\")\n\n    await callback_query.message.edit_reply_markup(reply_markup=InlineKeyboardMarkup(\n        resize_keyboard=True,\n        inline_keyboard=[\n            *get_rub_price_keyboard(\n                \"buy_card\",\n                [100000, 250000, 500000, 1000000, 2500000, 5000000],\n                model\n            ),\n            [\n                InlineKeyboardButton(text=\"‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã\",\n                                     callback_data=f\"back_buy_method {model}\"),\n            ]\n        ]))\n\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω–≤–æ–π—Å–∞ (Telegram Stars)\n@paymentsRouter.callback_query(StartWithQuery(\"buy_stars\"))\nasync def handle_buy_balance_model_query(callback_query: CallbackQuery):\n    amount = int(callback_query.data.split(\" \")[2])\n    tokens = callback_query.data.split(\" \")[1]\n    model = callback_query.data.split(\" \")[3]\n    await callback_query.message.answer_invoice(\n        title=\"–ü–æ–∫—É–ø–∫–∞ ‚ö°Ô∏è\",\n        description=f\"–ö—É–ø–∏—Ç—å {tokens}‚ö°Ô∏è?\",\n        prices=[LabeledPrice(label=\"XTR\", amount=amount)],\n        provider_token=\"\",\n        payload=f\"buy_balance {tokens.replace(',', '')} {model} stars\",\n        currency=\"XTR\",\n        reply_markup=payment_keyboard(amount),\n    )\n    await asyncio.sleep(0.5)\n    await callback_query.message.delete()\n\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω–≤–æ–π—Å–∞ (–ø–µ—Ä–µ–≤–æ–¥–æ–º –Ω–∞ —Å—á—ë—Ç)\n@paymentsRouter.callback_query(StartWithQuery(\"buy_card\"))\nasync def handle_buy_balance_model_query(callback_query: CallbackQuery):\n    amount = int(callback_query.data.split(\" \")[2]) * 100\n    tokens = callback_query.data.split(\" \")[1]\n    model = callback_query.data.split(\" \")[3]\n\n    await callback_query.bot.send_invoice(\n        callback_query.message.chat.id,\n        **buy_balance_product,\n        description=f\"ü§© –ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è\",\n        payload=f\"buy_balance {tokens.replace(',', '')} {model} card\",\n        prices=[types.LabeledPrice(label=f\"–ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è\", amount=amount)],\n        provider_data=json.dumps(\n            {\n                \"receipt\": {\n                    \"items\": [{\n                        \"description\": f\"ü§© –ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è\",\n                        \"quantity\": \"1\",\n                        \"amount\": {\n                            \"value\": str(int(amount / 100)) + \".00\",\n                            \"currency\": \"RUB\",\n                        },\n                        \"vat_code\": 1,\n                        \"payment_mode\" : \"full_payment\",\n                        \"payment_subject\" : \"commodity\"\n\n                    }],\n                    \"email\": \"edtimyr@gmail.com\"\n                }\n            }\n        )\n\n    )\n    print(\"PAYMENTS_TOKEN\")\n    print(config.PAYMENTS_TOKEN)\n    await asyncio.sleep(0.5)\n\n    await callback_query.message.delete()\n\n\n@paymentsRouter.callback_query(StartWithQuery(\"donation\"))\nasync def handle_change_model_query(callback_query: CallbackQuery):\n    amount = int(callback_query.data.split(\" \")[1]) * 100\n\n    await callback_query.bot.send_invoice(\n        callback_query.message.chat.id,\n        **donation_product,\n        prices=[types.LabeledPrice(label=\"–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ\", amount=amount)]\n    )\n\n    await asyncio.sleep(0.5)\n    await callback_query.message.delete()\n\n\n@paymentsRouter.pre_checkout_query(lambda query: True)\nasync def checkout_process(pre_checkout_query: types.PreCheckoutQuery):\n    logging.log(logging.INFO, pre_checkout_query)\n\n    await pre_checkout_query.bot.answer_pre_checkout_query(pre_checkout_query.id, ok=True)\n\n# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã\n@paymentsRouter.message(F.successful_payment)\nasync def successful_payment(message: types.Message):\n    logging.log(logging.INFO, \"SUCCESSFUL PAYMENT:\")\n    for k, v in message.successful_payment:\n        logging.log(logging.INFO, f\"{k} = {v}\")\n\n    if message.successful_payment.invoice_payload.startswith(\"donation\"):\n        await message.answer(\n            f\"ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount // 100} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–µ–∫—Ç–∞!\")\n        return\n\n    if message.successful_payment.invoice_payload.startswith(\"buy_balance\"):\n        await tokenizeService.get_tokens(message.from_user.id)\n\n        tokens = int(message.successful_payment.invoice_payload.split(\" \")[1])\n        await tokenizeService.update_token(message.from_user.id, tokens)\n\n        if message.successful_payment.invoice_payload.split(\" \")[3] == \"stars\":\n            await message.answer(\n                f\"ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–í–∞—à –±–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ *{tokens}*‚ö°Ô∏è!\")\n        else:\n            await message.answer(\n                f\"ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount // 100} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–í–∞—à –±–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ *{tokens}*‚ö°Ô∏è!\")\n\n        gpt_tokens = await tokenizeService.get_tokens(message.from_user.id)\n\n        await message.answer(f\"\"\"üíµ –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: *{gpt_tokens.get(\"tokens\")}*‚ö°Ô∏è",
    "line": 18
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "–û–ø–ª–∞—Ç–∏—Ç—å {stars} ‚≠êÔ∏è",
    "line": 42
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π üí≥",
    "line": 66
  },
  {
    "file": "../bot/payment/router.py",
    "type": "button",
    "text": "–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π üí≥",
    "line": 66
  },
  {
    "file": "../bot/payment/router.py",
    "type": "keyboard",
    "text": "–û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π üí≥",
    "line": 66
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "–í—ã–±–∏—Ä–µ—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã",
    "line": 86
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "–ë–∞–ª–∞–Ω—Å –∫–∞–∫–æ–π –º–æ–¥–µ–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ø–æ–ª–Ω–∏—Ç—å?",
    "line": 94
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "–í—ã–±–∏—Ä–µ—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã",
    "line": 105
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 177
  },
  {
    "file": "../bot/payment/router.py",
    "type": "button",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 177
  },
  {
    "file": "../bot/payment/router.py",
    "type": "keyboard",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 177
  },
  {
    "file": "../bot/payment/router.py",
    "type": "single",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 197
  },
  {
    "file": "../bot/payment/router.py",
    "type": "button",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 197
  },
  {
    "file": "../bot/payment/router.py",
    "type": "keyboard",
    "text": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã",
    "line": 197
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "–ö—É–ø–∏—Ç—å {tokens}‚ö°Ô∏è?",
    "line": 211
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "ü§© –ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è",
    "line": 232
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "–ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è",
    "line": 234
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "ü§© –ü–æ–∫—É–ø–∫–∞ {tokens}‚ö°Ô∏è",
    "line": 239
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount // 100} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–µ–∫—Ç–∞!",
    "line": 292
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–í–∞—à –±–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ *{tokens}*‚ö°Ô∏è!",
    "line": 303
  },
  {
    "file": "../bot/payment/router.py",
    "type": "fstring",
    "text": "ü§© –ü–ª–∞—Ç—ë–∂ –Ω–∞ —Å—É–º–º—É *{message.successful_payment.total_amount // 100} {message.successful_payment.currency}* –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ! ü§©\\n\\n–í–∞—à –±–∞–ª–∞–Ω—Å –ø–æ–ø–æ–ª–Ω–µ–Ω –Ω–∞ *{tokens}*‚ö°Ô∏è!",
    "line": 306
  },
  {
    "file": "../bot/referral/router.py",
    "type": "fstring",
    "text": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user_id} –∑–∞–ø—Ä–æ—Å–∏–ª —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É.",
    "line": 20
  },
  {
    "file": "../bot/referral/router.py",
    "type": "multiline",
    "text": "*5 000*‚ö°Ô∏è –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. \n*+500*‚ö°Ô∏è –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. \n\nüë©üèª‚Äçüíª –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤: *{len(referral['children'])}*\nü§ë –ï–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∞–≤—Ç–æ–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: *{referral['award']}*‚ö°Ô∏è\n\nüéâ –í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞: `{referral_link}`",
    "line": 29
  },
  {
    "file": "../bot/start/router.py",
    "type": "multiline",
    "text": "üëã –ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ deep.foundation!\n\nü§ñ –Ø –≥–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å –ª—é–±–æ–π –∑–∞–¥–∞—á–µ–π, –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –≤ –º–µ–Ω—é!\n\n/help - ‚ú® –æ–±–∑–æ—Ä –∫–æ–º–∞–Ω–¥ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π\n/balance - ‚ö°Ô∏è —É–∑–Ω–∞—Ç—å —Å–≤–æ–π –±–∞–ª–∞–Ω—Å\n/referral - üîó –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∏\n\n–í—Å—ë –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –µ—Å–ª–∏ –Ω–µ –ø–ª–∞—Ç–∏—Ç—å.\n–ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Ç–≤–æ–π –±–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –ø–æ–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ —Å—É–º–º—É –æ—Ç *10 000‚ö°Ô∏è* (—ç–Ω–µ—Ä–≥–∏–∏)!\n\n–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ:\nüíé –ú–æ–∂–Ω–æ –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å Telegram –∑–≤—ë–∑–¥–∞–º–∏ –∏–ª–∏ –±–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π.\nüë• –ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å? –ü–æ–¥–µ–ª–∏—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –¥—Ä—É–≥–∞! –ü—Ä–∏–≤–æ–¥—è –º–Ω–æ–≥–æ –¥—Ä—É–∑–µ–π —Ç—ã —Å–º–æ–∂–µ—à—å –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ.\n\n/referral - –ø–æ–ª—É—á–∞–π –±–æ–ª—å—à–µ —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π:\n*5 000‚ö°Ô∏èÔ∏è* –∑–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;\n*+500‚ö°Ô∏èÔ∏è* –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞ –∑–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞.\n\nüè† –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫ –∏–ª–∏ —Ö–æ—á–µ—à—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ–º, –Ω–∞–ø–∏—à–∏ –≤ –Ω–∞—à–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ @deepGPT.\n\"\"\"\n\nref_text = \"\"\"\nüëã –¢—ã –ø—Ä–∏–±—ã–ª –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –Ω—É–∂–Ω–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –º–æ–π –∫–∞–Ω–∞–ª.\n\"\"\"\n\nasync def handle_referral(message, user_id, ref_user_id):\n    result = await referralsService.create_referral(user_id, ref_user_id)\n    \n    print(result, 'resuuuuult')\n    \n    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ ref_user_id –≤–∞–ª–∏–¥–µ–Ω –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏—è\n    if not ref_user_id:\n        return  # –ü—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ ref_user_id –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç\n    \n    if not result or result.get(\"parent\") is None:\n        return\n    \n    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ ref_user_id - —á–∏—Å–ª–æ –∏–ª–∏ —Å—Ç—Ä–æ–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, username)\n    try:\n        chat_id = int(ref_user_id)  # –ï—Å–ª–∏ ref_user_id –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º\n    except (TypeError, ValueError):\n        await message.answer(\"‚ùå –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π ID.\")\n        return\n    \n    await message.answer(text=\"\"\"\nüéâ –í—ã –ø–æ–ª—É—á–∏–ª–∏ *5 000*‚ö°Ô∏è!\n\n/balance - ‚ú® –£–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üîó –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∏\n\"\"\")\n\n    await message.bot.send_message(\n        chat_id=chat_id,  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π chat_id\n        text=\"\"\"\nüéâ –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —Ä–µ—Ñ–µ—Ä–∞–ª! \n–í—ã –ø–æ–ª—É—á–∏–ª–∏ *5 000*‚ö°Ô∏è!\n–í–∞—à —Ä–µ—Ñ–µ—Ä–∞–ª –¥–æ–ª–∂–µ–Ω –ø—Ä–æ—è–≤–∏—Ç—å –ª—é–±—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –±–æ—Ç–µ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞, —á—Ç–æ–±—ã –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –µ—â–µ *5 000*‚ö°Ô∏è –∏ +500‚ö°Ô∏èÔ∏è –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞.\n\n/balance - ‚ú® –£–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üîó –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ä–µ—Ñ–µ—Ä–∞–ª–∫–∏\n\"\"\"\n    )\n\n\nasync def create_token_if_not_exist(user_id):\n    return await tokenizeService.get_tokens(user_id)\n\n@startRouter.message(CommandStart())\nasync def start(message: types.Message):\n    args_match = re.search(r'^/start\\s(\\S+)', message.text)\n    ref_user_id = args_match.group(1) if args_match else None\n\n    # always force sending the keyboard\n    keyboard = create_main_keyboard()\n    await send_message(message, text=hello_text, reply_markup=keyboard)\n\n    await create_token_if_not_exist(message.from_user.id)\n\n    is_subscribe = await check_subscription(message)\n\n    # –£–≤–µ–¥–æ–º–ª—è–µ–º —Ä–µ—Ñ–µ—Ä–µ—Ä–∞, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à—ë–ª –ø–æ —Å—Å—ã–ª–∫–µ, –Ω–æ –µ—â—ë –Ω–µ –ø–æ–¥–ø–∏—Å–∞–ª—Å—è\n    if ref_user_id: # and str(ref_user_id) != str(message.from_user.id) and not is_subscribe\n        try:\n            chat_id = int(ref_user_id)\n        except (TypeError, ValueError):\n            chat_id = None\n\n        if chat_id:\n            user_name = message.from_user.username\n            user_mention = f\"<a href='tg://user?id={message.from_user.id}'>{message.from_user.full_name}</a>\"\n            await message.bot.send_message(\n                chat_id=chat_id,\n                text=(\n                    f\"\"\"\nüéâ –ü–æ –≤–∞—à–µ–π —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ –ø–µ—Ä–µ—à–ª–∏: @{user_name} ({user_mention}).\n\n–ß—Ç–æ–±—ã –≤–∞—à–µ–º—É –¥—Ä—É–≥—É —Å—Ç–∞—Ç—å –≤–∞—à–∏–º —Ä–µ—Ñ–µ—Ä–∞–ª–æ–º, –æ–Ω –¥–æ–ª–∂–µ–Ω –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª @gptDeep.\n\n–ö–∞–∫ —Ç–æ–ª—å–∫–æ —ç—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –≤—ã –ø–æ–ª—É—á–∏—Ç–µ <b>5 000</b>‚ö°Ô∏è –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ –∏ <b>+500</b>‚ö°Ô∏èÔ∏è –∫ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é –±–∞–ª–∞–Ω—Å–∞.\n\n–ï—Å–ª–∏ –≤–¥—Ä—É–≥ —ç—Ç–æ–≥–æ –¥–æ–ª–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, —Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ –≤–∞—à–µ–º—É –¥—Ä—É–≥—É –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å, <b>–ø–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –µ–º—É –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</b>. \n–ï—Å–ª–∏ –∏ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, —Ç–æ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–µ @deepGPT –∏ –º—ã –ø–æ–º–æ–∂–µ–º –≤–∞–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å —Å–∏—Ç—É–∞—Ü–∏–µ–π.\n\"\"\"\n                ),\n                parse_mode=\"HTML\"\n            )\n\n    if not is_subscribe:\n        if str(ref_user_id) == str(message.from_user.id):\n            return\n\n        await message.answer(\n            text=ref_text,\n            reply_markup=types.InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=[\n                    [\n                        types.InlineKeyboardButton(text=\"–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è üëäüèª\", url=\"https://t.me/gptDeep\"),\n                    ],\n                    [\n                        types.InlineKeyboardButton(text=\"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ‚úÖ\",\n                                                   callback_data=f\"ref-is-subscribe {ref_user_id} {message.from_user.id}\"),\n                    ]\n                ]\n            )\n        )\n        return\n\n    await handle_referral(message, message.from_user.id, ref_user_id)\n\n\n@startRouter.callback_query(StartWithQuery(\"ref-is-subscribe\"))\nasync def handle_ref_is_subscribe_query(callback_query: CallbackQuery):\n    ref_user_id = callback_query.data.split(\" \")[1]\n    user_id = callback_query.data.split(\" \")[2]\n\n    is_subscribe = await check_subscription(callback_query.message, user_id)\n\n    if not is_subscribe:\n        await callback_query.message.answer(text=\"–í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å! üò°\")\n        return\n\n    await handle_referral(callback_query.message, user_id, ref_user_id)\n\n\n@startRouter.message(TextCommand([help_command(), help_text()]))\nasync def help_command(message: types.Message):\n    await message.answer(text=\"\"\"\n–û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ—Å—É—Äc –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º - ‚ö°Ô∏è (—ç–Ω–µ—Ä–≥–∏—è).\n–≠—Ç–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–µ—Å—É—Ä—Å –¥–ª—è –≤—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –±–æ—Ç–∞.\n\n–ö–∞–∂–¥–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å —Ç—Ä–∞—Ç–∏—Ç —Ä–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚ö°Ô∏è.\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω—ã—Ö ‚ö°Ô∏è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–ª–∏–Ω—ã –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞, –º–æ–¥–µ–ª–µ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π –∏ –æ–±—ä—ë–º–∞ –≤–∞—à–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.\n–î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É - /clear, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–∏–∞–ª–æ–≥–∞ –∏ –Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥ ‚ö°Ô∏è (—ç–Ω–µ—Ä–≥–∏–∏)! \n–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—á–∏—â–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –æ–±—Å—É–∂–¥–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–µ–º—ã. –ê —Ç–∞–∫–∂–µ –µ—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞—á–∞–ª–∞ –æ—Ç–∫–∞–∑—ã–≤–∞—Ç—å –≤ –ø–æ–º–æ—â–∏.\n\n/app - üî• –ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫—É –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é!\n/start - üîÑ –†–µ—Å—Ç–∞—Ä—Ç –±–æ—Ç–∞, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç, –ø–æ–º–æ–≥–∞–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏.\n/model - üõ†Ô∏è –°–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç, –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–º–µ–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –±–æ—Ç–∞.\n/system - ‚öôÔ∏è –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–º–µ–Ω–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–æ—Ç–æ–º.   \n/clear - üßπ –û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–±—ã—Ç—å –±–æ—Ç—É –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é.  \n/balance - ‚ú® –ë–∞–ª–∞–Ω—Å, –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å –±–∞–ª–∞–Ω—Å ‚ö°Ô∏è.\n/image - üñºÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ (Midjourney, DALL¬∑E 3, Flux, Stable Diffusion)\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å, –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å ‚ö°Ô∏è.\n/referral - üîó –ü–æ–ª—É—á–∏—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É\n/suno - üéµ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º—É–∑—ã–∫–∏ (Suno)\n/text - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\n\"\"\")\n\n\n@startRouter.message(TextCommand([app_command()]))\nasync def app_handler(message: Message):\n    await message.answer(\"\"\"–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: https://t.me/DeepGPTBot/App",
    "line": 16
  },
  {
    "file": "../bot/start/router.py",
    "type": "single",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è üëäüèª",
    "line": 135
  },
  {
    "file": "../bot/start/router.py",
    "type": "button",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è üëäüèª",
    "line": 135
  },
  {
    "file": "../bot/start/router.py",
    "type": "keyboard",
    "text": "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è üëäüèª",
    "line": 135
  },
  {
    "file": "../bot/start/router.py",
    "type": "single",
    "text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ‚úÖ",
    "line": 138
  },
  {
    "file": "../bot/start/router.py",
    "type": "button",
    "text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ‚úÖ",
    "line": 138
  },
  {
    "file": "../bot/start/router.py",
    "type": "keyboard",
    "text": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å ‚úÖ",
    "line": 138
  },
  {
    "file": "../bot/start/router.py",
    "type": "single",
    "text": "–í—ã –Ω–µ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å! üò°",
    "line": 157
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "Suno: –ø–æ–ª—É—á–µ–Ω audio_url: {audio_url}",
    "line": 30
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "Suno: —Å–∫–∞—á–∞–Ω —Ñ–∞–π–ª {ext} —Ä–∞–∑–º–µ—Ä–æ–º {len(response.content)} –±–∞–π—Ç",
    "line": 36
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "Suno: —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω mp3 —Ñ–∞–π–ª",
    "line": 46
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∞—É–¥–∏–æ: {e}",
    "line": 48
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–£–¥–∞–ª—è—é mp3_path: {mp3_path}",
    "line": 53
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–£–¥–∞–ª—è—é tmp_file_path: {tmp_file_path}",
    "line": 57
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "Suno: —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω mp3 —Ñ–∞–π–ª",
    "line": 63
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ mp3: {e}",
    "line": 65
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–£–¥–∞–ª—è—é tmp_file_path: {tmp_file_path}",
    "line": 70
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "Suno: –Ω–µ—Ç audio_url. generation={generation}",
    "line": 73
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∞—É–¥–∏–æ—Ñ–∞–π–ª –æ—Ç Suno.\\n\\n",
    "line": 79
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–°—Ç–∞—Ç—É—Å: {status}\\n",
    "line": 80
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–û—à–∏–±–∫–∞: {error_message}\\n\\n",
    "line": 81
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å.",
    "line": 82
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Suno –µ—â–µ? üî•",
    "line": 86
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 91
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 91
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 92
  },
  {
    "file": "../bot/suno/router.py",
    "type": "multiline",
    "text": "–£ –≤–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç *‚ö°Ô∏è*. üòî\n\n/balance - ‚ú® –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ë–∞–ª–∞–Ω—Å\n/buy - üíé –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å\n/referral - üë• –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ *‚ö°Ô∏è*!       \n\"\"\")\n            stateService.set_current_state(user_id, StateTypes.Default)\n            return\n\n        if is_empty_prompt(message.text):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-suno-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        if len(message.text) > 200:\n            await message.answer(\n                \"\"\"–û–ø–∏—Å–∞–Ω–∏–µ –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ *–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ 200 —Å–∏–º–≤–æ–ª–æ–≤* –¥–ª—è Suno.\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–º—Ç –∫–æ—Ä–æ—á–µ.\n\"\"\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-suno-generate\"\n                            )\n                        ],\n                    ],\n                )\n            )\n            return\n\n        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –∑–∞–ø—Ä–æ—Å—É —Å—Ç–∏–ª—è\n        sunoService.store_user_data(str(user_id), topic=message.text)\n        stateService.set_current_state(user_id, StateTypes.SunoStyle)\n\n        await message.answer(\n            text=\"\"\"–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å —É–∫–∞–∂–∏—Ç–µ *—Å—Ç–∏–ª—å* –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ.\n\n–ù–∞–ø—Ä–∏–º–µ—Ä: pop, rock, jazz, classical, electronic, folk, country, blues, hip-hop, reggae, latin, ambient, techno, house, r&b, soul, metal, punk, indie, alternative –∏ –¥—Ä—É–≥–∏–µ.\n\n*–ù–µ –±–æ–ª–µ–µ 50 —Å–∏–º–≤–æ–ª–æ–≤*.\n\"\"\",\n            reply_markup=InlineKeyboardMarkup(\n                resize_keyboard=True,\n                inline_keyboard=[\n                    [\n                        InlineKeyboardButton(\n                            text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                            callback_data=\"cancel-suno-generate\"\n                        )\n                    ],\n                ]\n            ),\n        )\n\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to process Suno topic: {e}\")\n        stateService.set_current_state(user_id, StateTypes.Default)\n        return\n\n\n@sunoRouter.message(StateCommand(StateTypes.SunoStyle))\nasync def suno_style_handler(message: Message):\n    user_id = message.from_user.id\n\n    try:\n        if not stateService.is_suno_style_state(user_id):\n            return\n\n        if is_empty_prompt(message.text):\n            await message.answer(\n                \"üö´ –í –≤–∞—à–µ–º –∑–∞–ø—Ä–æ—Å–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∏–ª—å –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-suno-generate\"\n                            )\n                        ]\n                    ],\n                )\n            )\n            return\n\n        if len(message.text) > 50:\n            await message.answer(\n                \"\"\"–°—Ç–∏–ª—å –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ *–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ 50 —Å–∏–º–≤–æ–ª–æ–≤*.\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –∫–æ—Ä–æ—á–µ.\n\"\"\",\n                reply_markup=InlineKeyboardMarkup(\n                    resize_keyboard=True,\n                    inline_keyboard=[\n                        [\n                            InlineKeyboardButton(\n                                text=\"–û—Ç–º–µ–Ω–∞ ‚ùå\",\n                                callback_data=\"cancel-suno-generate\"\n                            )\n                        ],\n                    ],\n                )\n            )\n            return\n\n        # –ü–æ–ª—É—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è\n        user_data = sunoService.get_user_data(str(user_id))\n        topic = user_data.get('topic', '')\n        style = message.text.strip()\n\n        if not topic:\n            await message.answer(\"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: —Ç–µ–º–∞ –ø–µ—Å–Ω–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ.\")\n            stateService.set_current_state(user_id, StateTypes.Default)\n            sunoService.clear_user_data(str(user_id))\n            return\n\n        stateService.set_current_state(user_id, StateTypes.Default)\n\n        wait_message = await message.answer(\n            f\"**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–¢–µ–º–∞: {topic}\\n–°—Ç–∏–ª—å: {style}\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: *3-5 –º–∏–Ω—É—Ç*.\\n–ú–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ—Ç–æ–º.\"\n        )\n\n        await message.bot.send_chat_action(message.chat.id, \"typing\")\n\n        async def task_id_get(task_id: str):\n            await message.answer(f\"`1:suno:{task_id}:generate`\")\n            await message.answer(\n                f\"\"\"–≠—Ç–æ ID –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.\n\n–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ —á–∞—Ç –∏ –ø–æ–ª—É—á–∏—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –ª—é–±–æ–π —É–¥–æ–±–Ω—ã–π –¥–ª—è –≤–∞—Å –º–æ–º–µ–Ω—Ç.\n                                \n–í—ã —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏.\n\"\"\"\n            )\n\n        generation = await sunoService.generate_suno(topic, style, task_id_get)\n\n        if not generation or not generation.get('data'):\n            await message.answer(\n                \"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º—É–∑—ã–∫–∏. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:\\n\"\n                \"‚Ä¢ –°–µ—Ä–≤–∏—Å Diffrhythm –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω\\n\"\n                \"‚Ä¢ –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (15 –º–∏–Ω—É—Ç)\\n\"\n                \"‚Ä¢ –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –ª–∏—Ä–∏–∫–∏\\n\\n\"\n                \"–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ —Ç–µ–º—É/—Å—Ç–∏–ª—å –ø–µ—Å–Ω–∏.\"\n            )\n            sunoService.clear_user_data(str(user_id))\n            return\n\n        await suno_create_messages(message, generation)\n\n        # –°–ø–∏—Å—ã–≤–∞–µ–º —Ç–æ–∫–µ–Ω—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ generation —É—Å–ø–µ—à–Ω–∞\n        status = generation.get('data', {}).get('status')\n        if status == \"completed\":\n            await tokenizeService.update_token(user_id, 5700, \"subtract\")\n            await message.answer(\n                f\"\"\"\nü§ñ –ó–∞—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ *Suno*: *5700*\n\n‚ùî /help - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ ‚ö°Ô∏è\n\"\"\"\n            )\n        else:\n            await message.answer(\n                \"‚ö°Ô∏è –≠–Ω–µ—Ä–≥–∏—è –Ω–µ –±—ã–ª–∞ —Å–ø–∏—Å–∞–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π.\"\n            )\n\n        await wait_message.delete()\n\n        # –û—á–∏—â–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ\n        sunoService.clear_user_data(str(user_id))\n\n    except Exception as e:\n        await message.answer(DEFAULT_ERROR_MESSAGE)\n        logging.error(f\"Failed to generate Suno: {e}\")\n        stateService.set_current_state(user_id, StateTypes.Default)\n        sunoService.clear_user_data(str(user_id))\n        return\n\n\n@sunoRouter.message(TextCommand([suno_command(), suno_text()]))\nasync def suno_prepare_handler(message: Message):\n    user_id = message.from_user.id\n    await enter_suno_state(user_id, message)\n\n\n@sunoRouter.callback_query(StartWithQuery(\"suno-generate\"))\nasync def suno_prepare_handler(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n    await enter_suno_state(user_id, callback_query.message)\n\n\n@sunoRouter.callback_query(StartWithQuery(\"cancel-suno-generate\"))\nasync def cancel_state(callback_query: CallbackQuery):\n    user_id = callback_query.from_user.id\n    stateService.set_current_state(user_id, StateTypes.Default)\n    sunoService.clear_user_data(str(user_id))\n    await callback_query.message.delete()\n    await callback_query.answer(\"–†–µ–∂–∏–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º—É–∑—ã–∫–∏ –≤ Suno —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω—ë–Ω!\")\n\n\nasync def enter_suno_state(user_id, message: Message):\n    stateService.set_current_state(user_id, StateTypes.Suno)\n\n    await message.answer(\n        text=\"\"\"*–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Ä–µ–∂–∏–º* –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º—É–∑—ã–∫–∏ –≤ *Suno*.\n\n*–°–ª–µ–¥—É—é—â–µ–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–∫ —Ç–µ–º–∞ –ø–µ—Å–Ω–∏* –¥–ª—è Suno.\n\n–ü–æ—Å–ª–µ —É–∫–∞–∑–∞–Ω–∏—è —Ç–µ–º—ã –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Å—Ç–∏–ª—å –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.\n\n–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç —Å—Ç–æ–∏—Ç—å *5700‚ö°Ô∏è*.\n\n–û–ø–∏—à–∏—Ç–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ *—Ç–µ–º—É* –º—É–∑—ã–∫–∞–ª—å–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ üéµ (*–Ω–µ –±–æ–ª–µ–µ 200 —Å–∏–º–≤–æ–ª–æ–≤*), –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç–µ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥—É–º–∞–ª–∏.",
    "line": 111
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 128
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 128
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 129
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 148
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 148
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 149
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 173
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 173
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 174
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 204
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 204
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 205
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 224
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 224
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 225
  },
  {
    "file": "../bot/suno/router.py",
    "type": "fstring",
    "text": "**‚åõÔ∏è–û–∂–∏–¥–∞–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é...**\\n–¢–µ–º–∞: {topic}\\n–°—Ç–∏–ª—å: {style}\\n–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è: *3-5 –º–∏–Ω—É—Ç*.\\n–ú–æ–∂–µ—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ—Ç–æ–º.",
    "line": 248
  },
  {
    "file": "../bot/suno/router.py",
    "type": "button",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 347
  },
  {
    "file": "../bot/suno/router.py",
    "type": "keyboard",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 347
  },
  {
    "file": "../bot/suno/router.py",
    "type": "single",
    "text": "–û—Ç–º–µ–Ω–∞ ‚ùå",
    "line": 348
  },
  {
    "file": "../bot/tasks/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Midjourney –µ—â–µ? üî•",
    "line": 39
  },
  {
    "file": "../bot/tasks/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 44
  },
  {
    "file": "../bot/tasks/router.py",
    "type": "single",
    "text": "C–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Flux –µ—â–µ? üî•",
    "line": 115
  },
  {
    "file": "../bot/tasks/router.py",
    "type": "fstring",
    "text": "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å üî•",
    "line": 120
  }
]